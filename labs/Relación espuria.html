
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>9.1. Regresión espuria &#8212; Apuntes de Macroeconometría</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mi-estilo.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="canonical" href="https://randall-romero.github.io/econometria/labs/Relación espuria.html" />
    <link rel="shortcut icon" href="../_static/r2-logo-icon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="9.2. Valores críticos de MacKinnon para test de cointegración" href="MacKinnon%20valores%20cr%C3%ADticos%20para%20test%20de%20cointegraci%C3%B3n.html" />
    <link rel="prev" title="9. Cointegración y VECM" href="chapter09.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-57200532-3', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/r2-logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Apuntes de Macroeconometría</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../00-acerca.html">
                    Inicio
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Acerca de este libro
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../01-interactuando.html">
   Cómo interactuar con este libro
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02-contenido.html">
   Tipo de contenido
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Teoría
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../teoria/01-intro/chapter01.html">
   1. Introducción al análisis de series de tiempo
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/01-intro/01-historia.html">
     1.1. Una breve historia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/01-intro/02-graficos.html">
     1.2. Representación gráfica de series de tiempo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/01-intro/03-rezagos.html">
     1.3. El operador de rezagos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/01-intro/04-procesos-estocasticos.html">
     1.4. Procesos estocásticos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/01-intro/05-series-tiempo.html">
     1.5. Series de tiempo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/01-intro/06-pruebas.html">
     1.6. Pruebas de series de tiempo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/01-intro/refs.html">
     1.7. Referencias
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../teoria/02-eqdiff/chapter02.html">
   2. Ecuaciones en diferencia
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/02-eqdiff/01-intro.html">
     2.1. Acerca de este capítulo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/02-eqdiff/02-sustitucion.html">
     2.2. Solución por sustituciones recursivas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/02-eqdiff/03-combinacion.html">
     2.3. Solución por combinación de soluciones homogéneas y particulares
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/02-eqdiff/04-operador.html">
     2.4. Solución por medio del operador de rezagos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/02-eqdiff/refs.html">
     2.5. Referencias
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../teoria/03-arma/chapter03.html">
   3. Modelos AutoRegresivos de Media Móvil (ARMA)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/03-arma/01-intro.html">
     3.1. Introducción
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/03-arma/02-MA.html">
     3.2. Proceso de media móvil MA(q)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/03-arma/03-AR.html">
     3.3. Proceso autorregresivo AR(p)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/03-arma/04-ARMA.html">
     3.4. Proceso autorregresivo de media móvil ARMA(p,q)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/03-arma/05-estimacion.html">
     3.5. Estimación de modelos ARMA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/03-arma/06-pronosticos.html">
     3.6. Pronósticos con modelos ARMA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/03-arma/refs.html">
     3.7. Referencias
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../teoria/04-arima/chapter04.html">
   4. Modelos de tendencia
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/04-arima/01-modelos-tendencia.html">
     4.1. Modelos de series con tendencia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/04-arima/02-removiendo.html">
     4.2. Removiendo una tendencia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/04-arima/03-raices-unitarias.html">
     4.3. Series con raíz unitaria y procesos ARIMA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/04-arima/04-pruebas.html">
     4.4. Detectando raíces unitarias
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/04-arima/05-hp.html">
     4.5. El filtro de Hodrick y Prescott
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/04-arima/refs.html">
     4.6. Referencias
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../teoria/05-cambioestructural/chapter05.html">
   5. Cambio estructural
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/05-cambioestructural/01-chow.html">
     5.1. La prueba de Chow
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/05-cambioestructural/02-conocido.html">
     5.2. Cambio estructural y raíces unitarias: fecha conocida
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/05-cambioestructural/03-desconocido.html">
     5.3. Cambio estructural y raíces unitarias: fecha desconocida
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/05-cambioestructural/refs.html">
     5.4. Referencias
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../teoria/06-estacional/chapter06.html">
   6. Modelos de estacionalidad
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/06-estacional/01-intro.html">
     6.1. Introducción
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/06-estacional/02-sarima.html">
     6.2. Modelo ARIMA estacional
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/06-estacional/03-x13arima.html">
     6.3. Ajuste estacional
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/06-estacional/04-raices-unitarias.html">
     6.4. Raíces unitarias estacionales
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/06-estacional/refs.html">
     6.5. Referencias
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../teoria/07-sem/chapter07.html">
   7. Sistemas de ecuaciones simultáneas
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/07-sem/01-motivacion.html">
     7.1. Motivación
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/07-sem/02-sur.html">
     7.2. El modelo SUR
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/07-sem/03-representacion.html">
     7.3. Representación de ecuaciones simultáneas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/07-sem/04-identificacion.html">
     7.4. Identificación
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/07-sem/05-recursivo.html">
     7.5. El modelo recursivo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/07-sem/06-error.html">
     7.6. El término de error
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/07-sem/07-estimacion.html">
     7.7. Estimación
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/07-sem/refs.html">
     7.8. Referencias
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../teoria/08-var/chapter08.html">
   8. Vectores Auto-Regresivos (VAR)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/08-var/01-representaciones.html">
     8.1. Representaciones alternativas de un VAR
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/08-var/02-dinamica.html">
     8.2. Dinámica de un VAR
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/08-var/03-estimacion.html">
     8.3. Estimación
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/08-var/04-pronostico.html">
     8.4. Pronósticos con VAR
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../teoria/08-var/refs.html">
     8.5. Referencias
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Laboratorios
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="chapter01.html">
   1. Introducción al análisis de series de tiempo
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="Componentes-IMAE.html">
     1.1. Descomposición del IMAE por componentes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="correlogram.html">
     1.2. Autocorrelograma y pruebas de ruido blanco para el IMAE de Costa Rica
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="covariance-stationarity-3d-plots.html">
     1.3. Ilustrando la diferencia entre serie de tiempo y proceso estocástico, estacionario y no estacionario
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="LandD.html">
     1.4. El operador de rezagos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Transforme.html">
     1.5. Cálculo de transformaciones de la serie del PIB de Costa Rica
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="wntestq.html">
     1.6. Las pruebas de Box-Pierce y Ljung-Box.
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="chapter02.html">
   2. Ecuaciones en diferencia
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="EqDiff2.html">
     2.1. Resolviendo una ecuación en diferencia con
     <code class="docutils literal notranslate">
      <span class="pre">
       sympy
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="chapter03.html">
   3. Modelos AutoRegresivos de Media Móvil (ARMA)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="ISI-AR3.html">
     3.1. Estimación de un modelo ARMA de inflación para Costa Rica
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="demandadinero.html">
     3.2. Estimación de la demanda de dinero
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="chapter04.html">
   4. Modelos de tendencia
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="DickeyFuller.html">
     4.1. Replicando el trabajo de Dickey y Fuller
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="GrangerNewbold.html">
     4.2. Replicando el trabajo de Granger y Newbold 1974
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="KPSS.html">
     4.3. Replicando el trabajo de KPSS (1992)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="NelsonPlosser.html">
     4.4. Replicando el trabajo de Nelson y Plosser (1982)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tendencias-pib.html">
     4.5. Pruebas de raíz unitaria para el PIB en Costa Rica
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tendencias-simulaciones.html">
     4.6. Series integradas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter05.html">
   5. Cambio estructural
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="chapter06.html">
   6. Modelos de estacionalidad
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="SJO-pasajeros.html">
     6.1. Estacionalidad del número de pasajeros del aeropuerto Juan Santamaría
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="chapter07.html">
   7. Sistemas de ecuaciones simultáneas
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="Klein%20model.html">
     7.1. Estimación del modelo I de Klein por Mínimos Cuadrados en 2 etapas (2SLS)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="telara%C3%B1a.html">
     7.2. El modelo de la telaraña
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="chapter08.html">
   8. Vectores Auto-Regresivos (VAR)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="Simulacion%20de%20un%20VAR.html">
     8.1. Simulación de un VAR(1)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="VAR%20insesgado%20y%20consistente.html">
     8.2. Estimador OLS del VAR(1) es consistente e insesgado
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="VAR%20politica%20monetaria%20CR.html">
     8.3. Estimación de un VAR de la política monetaria de Costa Rica
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="VAR%281%29%20clase.html">
     8.4. Una clase para representar un VAR(1)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="chapter09.html">
   9. Cointegración y VECM
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
  <label for="toctree-checkbox-16">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     9.1. Regresión espuria
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="MacKinnon%20valores%20cr%C3%ADticos%20para%20test%20de%20cointegraci%C3%B3n.html">
     9.2. Valores críticos de MacKinnon para test de cointegración
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Apéndices
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../apendices/py-intro/py-chapter.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
  <label for="toctree-checkbox-17">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../apendices/py-intro/Python-01--Para%20qu%C3%A9%20aprender%20Python.html">
     Introducción a Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../apendices/py-intro/Python-02--Variables%20y%20operaciones%20b%C3%A1sicas.html">
     Variables y operaciones básicas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../apendices/py-intro/Python-03--Textos.html">
     Manipulando Textos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../apendices/py-intro/Python-04--Colecciones.html">
     Colecciones
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../apendices/py-intro/Python-05--Control%20de%20ejecuci%C3%B3n.html">
     Control de ejecución
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../apendices/py-intro/Python-06--Funciones.html">
     Funciones
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../apendices/py-intro/Python-07--M%C3%B3dulos.html">
     Módulos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../apendices/py-intro/Python-08--Clases%20y%20objetos.html">
     Clases y objetos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../apendices/py-intro/Python-09--manipulando-datos.html">
     Importando y manipulando datos con Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../apendices/py-intro/Python-10--Webscraping.html">
     Web scraping con BeautifulSoup
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../apendices/py-intro/Python-11--Leyendo-archivos-XML.html">
     Leyendo archivos XML
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../apendices/matematica/matematica.html">
   Matemática
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
  <label for="toctree-checkbox-18">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../apendices/matematica/01-algebra-lineal.html">
     Álgebra lineal
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../apendices/matematica/02-numeros-complejos.html">
     Números complejos
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../apendices/estadistica/estadistica.html">
   Estadística y econometría
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
  <label for="toctree-checkbox-19">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../apendices/estadistica/01-estadistica.html">
     Resultados de teoría estadística
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../apendices/estadistica/02-econometria.html">
     Resultados de econometría
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../apendices/estadistica/Futbol-Bernoulli-Teorema-L%C3%ADmite-Central.html">
     Ilustración del Teorema del Límite Central
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            <a href="http://randall-romero.com">randall-romero.com</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/randall-romero/econometria/master?urlpath=lab/tree/./labs/Relación espuria.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/randall-romero/econometria/blob/master/./labs/Relación espuria.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/labs/Relación espuria.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#preparacion">
   Preparación
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#regresion-con-datos-de-costa-rica-y-de-malta">
   Regresión con datos de Costa Rica y de Malta
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulacion-de-datos">
   Simulación de datos
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#monte-carlo">
   Monte Carlo
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Regresión espuria</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#preparacion">
   Preparación
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#regresion-con-datos-de-costa-rica-y-de-malta">
   Regresión con datos de Costa Rica y de Malta
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulacion-de-datos">
   Simulación de datos
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#monte-carlo">
   Monte Carlo
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="regresion-espuria">
<h1><span class="section-number">9.1. </span>Regresión espuria<a class="headerlink" href="#regresion-espuria" title="Permalink to this headline">#</a></h1>
<p>Estos apuntes tienen por objetivo ilustrar el problema que surge de estimar modelos de regresión lineal con series de tiempo no estacionarias (regresión espuria).</p>
<p>En primer lugar, se estima una regresión en la que el PIB per capita de Costa Rica depende del de Malta (a priori, no esperaríamos que el PIB per capita de Malta tenga impacto en el de Costa Rica).  Más adelante, realizamos experimentos de Monte Carlo para analizar las consecuencias de estimar regresiones con datos no estacionarios.</p>
<div class="section" id="preparacion">
<h2>Preparación<a class="headerlink" href="#preparacion" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">statsmodels.api</span> <span class="kn">import</span> <span class="n">OLS</span>
<span class="kn">from</span> <span class="nn">statsmodels.formula.api</span> <span class="kn">import</span> <span class="n">ols</span>

<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.float_format&#39;</span><span class="p">,</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">GITHUB_REPO</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/randall-romero/econometria/master/data/&quot;</span>
<span class="n">DATAPATH</span> <span class="o">=</span> <span class="n">GITHUB_REPO</span> <span class="k">if</span> <span class="s1">&#39;google.colab&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">get_ipython</span><span class="p">())</span> <span class="k">else</span> <span class="s1">&#39;../data/&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>Necesitamos importar una clase de un módulo local. Para ello, usualmente es suficiente con tener el módulo (archivo py) en la misma carpeta que este cuaderno, pero eso no funcionaría cuando se corre en Colab. Por ello, añadimos explícitamente la carpeta que contiene ese módulo en el path de Python.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">DATAPATH</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">mackinnon</span> <span class="kn">import</span> <span class="n">MacKinnon</span>  <span class="c1"># este módulo contiene herramientas para calcular valores críticos de MacKinnon</span>
</pre></div>
</div>
</div>
</div>
<p>La función AEG acá definida realizará la prueba (aún no Aumentada) de Engle y Granger a partir de los residuos de una regresión</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mk</span> <span class="o">=</span> <span class="n">MacKinnon</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">AEG</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">summary</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Prueba de cointegración de Engle y Granger&#39;&#39;&#39;</span>
    <span class="n">aux</span> <span class="o">=</span> <span class="n">OLS</span><span class="p">(</span><span class="n">residuals</span><span class="o">.</span><span class="n">diff</span><span class="p">(),</span> <span class="n">residuals</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">missing</span><span class="o">=</span><span class="s1">&#39;drop&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">aux</span><span class="o">.</span><span class="n">tvalues</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">nobs</span> <span class="o">=</span> <span class="n">aux</span><span class="o">.</span><span class="n">nobs</span>
    
    <span class="n">crit</span> <span class="o">=</span> <span class="n">mk</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">nobs</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">summary</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Prueba de cointegración de Engle y Granger&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ADF stat = </span><span class="si">%.3f</span><span class="se">\n</span><span class="s1">Critical values:&#39;</span> <span class="o">%</span> <span class="n">t</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">crit</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="si">%5s</span><span class="s1">: </span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">crit</span><span class="p">[</span><span class="s1">&#39;1%&#39;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Series están cointegradas (al 1</span><span class="si">% s</span><span class="s1">ignificancia)&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">crit</span><span class="p">[</span><span class="s1">&#39;5%&#39;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Series están cointegradas (al 5</span><span class="si">% s</span><span class="s1">ignificancia)&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">crit</span><span class="p">[</span><span class="s1">&#39;10%&#39;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Series están cointegradas (al 10</span><span class="si">% s</span><span class="s1">ignificancia)&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Series no están cointegradas&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">t</span>
       
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="regresion-con-datos-de-costa-rica-y-de-malta">
<h2>Regresión con datos de Costa Rica y de Malta<a class="headerlink" href="#regresion-con-datos-de-costa-rica-y-de-malta" title="Permalink to this headline">#</a></h2>
<p>Los datos fueron obtenidos directamente del Banco Mundial, usando el paquete <code class="docutils literal notranslate"><span class="pre">wbdata</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s2">&quot;https://github.com/randall-romero/econometria/raw/master/data/datos-CRI-MLT.pickle&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Reading data from datos-CRI-MLT.pickle.
</pre></div>
</div>
</div>
</div>
<p>Cargados los datos, los graficamos y mostramos las últimas 8 observaciones en una tabla.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">data</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>country</th>
      <th>CRI</th>
      <th>MLT</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2012</th>
      <td>8689.97</td>
      <td>21691.26</td>
    </tr>
    <tr>
      <th>2013</th>
      <td>8785.74</td>
      <td>22375.04</td>
    </tr>
    <tr>
      <th>2014</th>
      <td>8993.53</td>
      <td>23842.23</td>
    </tr>
    <tr>
      <th>2015</th>
      <td>9219.39</td>
      <td>25798.47</td>
    </tr>
    <tr>
      <th>2016</th>
      <td>9509.74</td>
      <td>26645.86</td>
    </tr>
    <tr>
      <th>2017</th>
      <td>9732.27</td>
      <td>27669.37</td>
    </tr>
    <tr>
      <th>2018</th>
      <td>9889.74</td>
      <td>28594.30</td>
    </tr>
    <tr>
      <th>2019</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/Relación espuria_12_1.png" src="../_images/Relación espuria_12_1.png" />
</div>
</div>
<p>Los datos originales están en niveles. Para la regresión
$<span class="math notranslate nohighlight">\( \log(CRI) = c + \log(MLT) + \epsilon \)</span>$</p>
<p>se necesita calcular el logaritmo de cada serie. Acá simplemente hacemos una base nueva <code class="docutils literal notranslate"><span class="pre">ldata</span></code> a partir de la original.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ldata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Ahora sí, estimamos la regresión con el función <code class="docutils literal notranslate"><span class="pre">ols</span></code>. Nótese que según los resultados, un aumento de un punto porcentual en el PIB de Malta está asociado con una disminución de 0.4494 pp en Costa Rica; el resultado es estadísticamente significativo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s1">&#39;CRI ~ MLT&#39;</span><span class="p">,</span><span class="n">ldata</span><span class="p">)</span>
<span class="n">resultados</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">resultados</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>           <td>CRI</td>       <th>  R-squared:         </th> <td>   0.806</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.802</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   195.0</td>
</tr>
<tr>
  <th>Date:</th>             <td>Sun, 24 Apr 2022</td> <th>  Prob (F-statistic):</th> <td>2.40e-18</td>
</tr>
<tr>
  <th>Time:</th>                 <td>11:58:04</td>     <th>  Log-Likelihood:    </th> <td>  34.197</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>    49</td>      <th>  AIC:               </th> <td>  -64.39</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>    47</td>      <th>  BIC:               </th> <td>  -60.61</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     1</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>    4.4814</td> <td>    0.300</td> <td>   14.916</td> <td> 0.000</td> <td>    3.877</td> <td>    5.086</td>
</tr>
<tr>
  <th>MLT</th>       <td>    0.4432</td> <td>    0.032</td> <td>   13.966</td> <td> 0.000</td> <td>    0.379</td> <td>    0.507</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>57.494</td> <th>  Durbin-Watson:     </th> <td>   0.064</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>   5.218</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.156</td> <th>  Prob(JB):          </th> <td>  0.0736</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 1.432</td> <th>  Cond. No.          </th> <td>    164.</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">resultados</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                    CRI   R-squared:                       0.806
Model:                            OLS   Adj. R-squared:                  0.802
Method:                 Least Squares   F-statistic:                     195.0
Date:                Sun, 24 Apr 2022   Prob (F-statistic):           2.40e-18
Time:                        11:58:04   Log-Likelihood:                 34.197
No. Observations:                  49   AIC:                            -64.39
Df Residuals:                      47   BIC:                            -60.61
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      4.4814      0.300     14.916      0.000       3.877       5.086
MLT            0.4432      0.032     13.966      0.000       0.379       0.507
==============================================================================
Omnibus:                       57.494   Durbin-Watson:                   0.064
Prob(Omnibus):                  0.000   Jarque-Bera (JB):                5.218
Skew:                           0.156   Prob(JB):                       0.0736
Kurtosis:                       1.432   Cond. No.                         164.
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
<p>Ahora bien, observe que los residuos no parecen ser ruido blanco.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span><span class="o">.</span><span class="n">resid</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;date&#39;&gt;
</pre></div>
</div>
<img alt="../_images/Relación espuria_19_1.png" src="../_images/Relación espuria_19_1.png" />
</div>
</div>
<p>Esto lo podemos confirmar con la prueba de Dickey y Fuller. Dado que al parecer los residuos tienen raíz unitaria, podemos inferir que el PIB de Costa Rica <strong>no está cointegrado</strong> con el de Malta.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">=</span><span class="n">AEG</span><span class="p">(</span><span class="n">resultados</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Prueba de cointegración de Engle y Granger
ADF stat = -0.532
Critical values:
	   1%: -4.138
	   5%: -3.470
	  10%: -3.130
Series no están cointegradas
</pre></div>
</div>
</div>
</div>
<p>Ahora bien, nótese que el problema de regresión espuria (casi) desaparece una vez corremos la regresión con series estacionarias (en este caso, el crecimiento en cada país).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modeldiff</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s1">&#39;CRI ~ MLT&#39;</span><span class="p">,</span><span class="n">ldata</span><span class="o">.</span><span class="n">diff</span><span class="p">())</span>
<span class="n">modeldiff</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>           <td>CRI</td>       <th>  R-squared:         </th> <td>   0.032</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.011</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   1.537</td>
</tr>
<tr>
  <th>Date:</th>             <td>Sun, 24 Apr 2022</td> <th>  Prob (F-statistic):</th>  <td> 0.221</td> 
</tr>
<tr>
  <th>Time:</th>                 <td>11:58:04</td>     <th>  Log-Likelihood:    </th> <td>  102.51</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>    48</td>      <th>  AIC:               </th> <td>  -201.0</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>    46</td>      <th>  BIC:               </th> <td>  -197.3</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     1</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>    0.0143</td> <td>    0.006</td> <td>    2.269</td> <td> 0.028</td> <td>    0.002</td> <td>    0.027</td>
</tr>
<tr>
  <th>MLT</th>       <td>    0.1378</td> <td>    0.111</td> <td>    1.240</td> <td> 0.221</td> <td>   -0.086</td> <td>    0.362</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>27.205</td> <th>  Durbin-Watson:     </th> <td>   1.244</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  58.241</td>
</tr>
<tr>
  <th>Skew:</th>          <td>-1.586</td> <th>  Prob(JB):          </th> <td>2.26e-13</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 7.365</td> <th>  Cond. No.          </th> <td>    26.4</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">modeldiff</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                    CRI   R-squared:                       0.032
Model:                            OLS   Adj. R-squared:                  0.011
Method:                 Least Squares   F-statistic:                     1.537
Date:                Sun, 24 Apr 2022   Prob (F-statistic):              0.221
Time:                        11:58:04   Log-Likelihood:                 102.51
No. Observations:                  48   AIC:                            -201.0
Df Residuals:                      46   BIC:                            -197.3
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      0.0143      0.006      2.269      0.028       0.002       0.027
MLT            0.1378      0.111      1.240      0.221      -0.086       0.362
==============================================================================
Omnibus:                       27.205   Durbin-Watson:                   1.244
Prob(Omnibus):                  0.000   Jarque-Bera (JB):               58.241
Skew:                          -1.586   Prob(JB):                     2.26e-13
Kurtosis:                       7.365   Cond. No.                         26.4
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="simulacion-de-datos">
<h2>Simulación de datos<a class="headerlink" href="#simulacion-de-datos" title="Permalink to this headline">#</a></h2>
<p>Ahora, vamos a definir una función para simular dos caminatas aleatorias con intercepto, calibradas con la media y la desviación estándar del crecimiento en ambos países.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">growth</span> <span class="o">=</span> <span class="n">ldata</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> 
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;El crecimiento medio es:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">growth</span><span class="p">)</span>

<span class="n">sigma</span> <span class="o">=</span> <span class="n">ldata</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">y las respectivas volatilidades son:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sigma</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>El crecimiento medio es:
country
CRI   0.02
MLT   0.04
dtype: float64

y las respectivas volatilidades son:
country
CRI   0.03
MLT   0.04
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Para las simulaciones, fijamos el tamaño de muestra en <code class="docutils literal notranslate"><span class="pre">T=48</span></code>. Observe que las dos series que se crean son independientes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="mi">48</span>
<span class="n">calendario</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;1970&#39;</span><span class="p">,</span><span class="n">freq</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">periods</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">generate_series</span><span class="p">():</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">T</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="n">X</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">growth</span> <span class="o">+</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">calendario</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;MLT&#39;</span><span class="p">,</span><span class="s1">&#39;CRI&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Aquí simulamos el proceso una vez para ver que parezca razonable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datos_simulados</span> <span class="o">=</span> <span class="n">generate_series</span><span class="p">()</span>
<span class="n">datos_simulados</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../_images/Relación espuria_30_1.png" src="../_images/Relación espuria_30_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados_simulados</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s1">&#39;CRI ~ MLT&#39;</span><span class="p">,</span><span class="n">datos_simulados</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<span class="n">resultados_simulados</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>           <td>CRI</td>       <th>  R-squared:         </th> <td>   0.910</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.908</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   464.6</td>
</tr>
<tr>
  <th>Date:</th>             <td>Sun, 24 Apr 2022</td> <th>  Prob (F-statistic):</th> <td>1.11e-25</td>
</tr>
<tr>
  <th>Time:</th>                 <td>11:58:06</td>     <th>  Log-Likelihood:    </th> <td>  13.619</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>    48</td>      <th>  AIC:               </th> <td>  -23.24</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>    46</td>      <th>  BIC:               </th> <td>  -19.50</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     1</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>   -0.2903</td> <td>    0.117</td> <td>   -2.477</td> <td> 0.017</td> <td>   -0.526</td> <td>   -0.054</td>
</tr>
<tr>
  <th>MLT</th>       <td>    1.7084</td> <td>    0.079</td> <td>   21.555</td> <td> 0.000</td> <td>    1.549</td> <td>    1.868</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td> 2.562</td> <th>  Durbin-Watson:     </th> <td>   0.137</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.278</td> <th>  Jarque-Bera (JB):  </th> <td>   2.329</td>
</tr>
<tr>
  <th>Skew:</th>          <td>-0.452</td> <th>  Prob(JB):          </th> <td>   0.312</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 2.410</td> <th>  Cond. No.          </th> <td>    9.29</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</div></div>
</div>
</div>
<div class="section" id="monte-carlo">
<h2>Monte Carlo<a class="headerlink" href="#monte-carlo" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">joblib</span> <span class="kn">import</span> <span class="n">Parallel</span><span class="p">,</span> <span class="n">delayed</span>

<span class="k">def</span> <span class="nf">Monte_Carlo</span><span class="p">(</span><span class="n">funcion</span><span class="p">,</span> <span class="n">repeticiones</span><span class="p">,</span> <span class="n">columnas</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ejecuta simulaciones de Montecarlo en paralelo, aprovechando todos los núcleos del procesador</span>

<span class="sd">    Argumentos:</span>
<span class="sd">        funcion: una función que dé por resultado una única realización de las cantidades que se desean simular</span>
<span class="sd">        repeticiones: un entero que indica cuántas muestras se desean simular</span>
<span class="sd">        columnas: una lista (o tupla) de strings, que identifiquen a las cantidades individuales retornadas por funcion</span>
<span class="sd">        *args, **kwargs: otros parámetros requeridos por funcion</span>

<span class="sd">    Retorna:</span>
<span class="sd">         Un data frame de pandas, con tantas filas como `repeticiones` y columnas como textos en `columnas`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datos</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)(</span><span class="n">delayed</span><span class="p">(</span><span class="n">funcion</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">repeticiones</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">datos</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columnas</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Para la simulación de Monte Carlo, veremos el parámetro asociado con MLT, así como su estadístico <em>t</em> y el valor <em>p</em>. Para facilitar la labor, definimos una función que extrae estos tres estadísticos de los resultados de una regresión y los retorna como una lista. Añadimos ademas el <em>p-value</em> de la prueba aumentada de Dickey-Fuller respecto a si los residuos de la regresión presentan raices unitarias.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">give_me_the_summary</span><span class="p">(</span><span class="n">res</span><span class="p">):</span>
    <span class="n">statistics</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">,</span> <span class="s1">&#39;tvalues&#39;</span><span class="p">,</span> <span class="s1">&#39;pvalues&#39;</span><span class="p">]</span>
    <span class="n">tval</span> <span class="o">=</span> <span class="n">AEG</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">k</span><span class="p">)[</span><span class="s1">&#39;MLT&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">statistics</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">tval</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Para cada iteración del experimento de Monte Carlo, generamos una nueva muestra con <code class="docutils literal notranslate"><span class="pre">generate_series()</span></code>, luego estimamos el modelo con los datos en niveles (resultados en <code class="docutils literal notranslate"><span class="pre">rl</span></code>) y en primeras diferencias (<code class="docutils literal notranslate"><span class="pre">rd</span></code>). Retornamos los seis estadísticos correspondientes.</p>
<p>Recuerde que, por construcción, las series en primera diferencia sí son estacionarias.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">simulate_regression</span><span class="p">():</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">generate_series</span><span class="p">()</span>
    <span class="n">rl</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s1">&#39;CRI ~ MLT&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
    <span class="n">rd</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s1">&#39;CRI ~ MLT&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">diff</span><span class="p">())</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">give_me_the_summary</span><span class="p">(</span><span class="n">rl</span><span class="p">)</span> <span class="o">+</span> <span class="n">give_me_the_summary</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Fijamos el número de repeticiones en <code class="docutils literal notranslate"><span class="pre">nrep=1000</span></code> y creamos una tabla (<code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code>) con los resultados de todas las simulaciones.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">nrep</span> <span class="o">=</span> <span class="mi">10000</span> <span class="c1"># number of repetitions</span>
<span class="n">montecarlo</span> <span class="o">=</span> <span class="n">Monte_Carlo</span><span class="p">(</span><span class="n">simulate_regression</span><span class="p">,</span> <span class="n">nrep</span><span class="p">,</span> <span class="n">columnas</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="s1">&#39;LEVEL&#39;</span><span class="p">,</span><span class="s1">&#39;DIFF&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;coeff&#39;</span><span class="p">,</span><span class="s1">&#39;t-stat&#39;</span><span class="p">,</span> <span class="s1">&#39;p-value&#39;</span><span class="p">,</span> <span class="s1">&#39;tvalue-res&#39;</span><span class="p">]]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Wall time: 2min 23s
</pre></div>
</div>
</div>
</div>
<p>Finalmente, analizamos la distribución de cada uno de los estadísticos bajo consideración.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">montecarlo</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">],</span><span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">mk</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Level
1%    -4.14
5%    -3.47
10%   -3.13
dtype: float64
</pre></div>
</div>
<img alt="../_images/Relación espuria_41_1.png" src="../_images/Relación espuria_41_1.png" />
</div>
</div>
<p>Puede verse para las regresiones en niveles, siempre encontramos una asociación positiva y estadísticamente significativa entre las dos series, a pesar de que son independientes! En contraste, cuando las regresiones se realizan con datos estacionarios (primeras diferencias), rutinariamente rechazaríamos la hipótesis de que el PIB de Malta está correlacionado con el de Costa Rica.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./labs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="chapter09.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">9. </span>Cointegración y VECM</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="MacKinnon%20valores%20cr%C3%ADticos%20para%20test%20de%20cointegraci%C3%B3n.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">9.2. </span>Valores críticos de MacKinnon para test de cointegración</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Randall Romero Aguilar<br/>
  
      &copy; Copyright 2021-2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>