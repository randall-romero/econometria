
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>6.2. Modelo ARIMA estacional &#8212; Apuntes de Macroeconometría</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mi-estilo.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="canonical" href="https://randall-romero.github.io/econometria/teoria/06-estacional/02-sarima.html" />
    <link rel="shortcut icon" href="../../_static/r2-logo-icon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="6.3. Ajuste estacional" href="03-x13arima.html" />
    <link rel="prev" title="6.1. Introducción" href="01-intro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-57200532-3', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/r2-logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Apuntes de Macroeconometría</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../00-acerca.html">
   Inicio
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Acerca de este libro
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../01-interactuando.html">
   Cómo interactuar con este libro
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../02-contenido.html">
   Tipo de contenido
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Teoría
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../01-intro/chapter01.html">
   1. Introducción al análisis de series de tiempo
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-intro/01-historia.html">
     1.1. Una breve historia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-intro/02-graficos.html">
     1.2. Representación gráfica de series de tiempo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-intro/03-rezagos.html">
     1.3. El operador de rezagos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-intro/04-procesos-estocasticos.html">
     1.4. Procesos estocásticos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-intro/05-series-tiempo.html">
     1.5. Series de tiempo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-intro/06-pruebas.html">
     1.6. Pruebas de series de tiempo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-intro/refs.html">
     1.7. Referencias
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../02-eqdiff/chapter02.html">
   2. Ecuaciones en diferencia
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-eqdiff/01-intro.html">
     2.1. Acerca de este capítulo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-eqdiff/02-sustitucion.html">
     2.2. Solución por sustituciones recursivas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-eqdiff/03-combinacion.html">
     2.3. Solución por combinación de soluciones homogéneas y particulares
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-eqdiff/04-operador.html">
     2.4. Solución por medio del operador de rezagos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-eqdiff/refs.html">
     2.5. Referencias
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../03-arma/chapter03.html">
   3. Modelos AutoRegresivos de Media Móvil (ARMA)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-arma/01-intro.html">
     3.1. Introducción
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-arma/02-MA.html">
     3.2. Proceso de media móvil MA(q)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-arma/03-AR.html">
     3.3. Proceso autorregresivo AR(p)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-arma/04-ARMA.html">
     3.4. Proceso autorregresivo de media móvil ARMA(p,q)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-arma/05-estimacion.html">
     3.5. Estimación de modelos ARMA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-arma/06-pronosticos.html">
     3.6. Pronósticos con modelos ARMA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-arma/refs.html">
     3.7. Referencias
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../04-arima/chapter04.html">
   4. Modelos de tendencia
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../04-arima/01-modelos-tendencia.html">
     4.1. Modelos de series con tendencia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04-arima/02-removiendo.html">
     4.2. Removiendo una tendencia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04-arima/03-raices-unitarias.html">
     4.3. Series con raíz unitaria y procesos ARIMA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04-arima/04-pruebas.html">
     4.4. Detectando raíces unitarias
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04-arima/05-hp.html">
     4.5. El filtro de Hodrick y Prescott
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04-arima/refs.html">
     4.6. Referencias
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../05-cambioestructural/chapter05.html">
   5. Cambio estructural
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../05-cambioestructural/01-chow.html">
     5.1. La prueba de Chow
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05-cambioestructural/02-conocido.html">
     5.2. Cambio estructural y raíces unitarias: fecha conocida
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05-cambioestructural/03-desconocido.html">
     5.3. Cambio estructural y raíces unitarias: fecha desconocida
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05-cambioestructural/refs.html">
     5.4. Referencias
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="chapter06.html">
   6. Modelos de estacionalidad
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01-intro.html">
     6.1. Introducción
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     6.2. Modelo ARIMA estacional
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03-x13arima.html">
     6.3. Ajuste estacional
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04-raices-unitarias.html">
     6.4. Raíces unitarias estacionales
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="refs.html">
     6.5. Referencias
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../07-sem/chapter07.html">
   7. Sistemas de ecuaciones simultáneas
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../07-sem/01-motivacion.html">
     7.1. Motivación
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../07-sem/02-sur.html">
     7.2. El modelo SUR
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../07-sem/03-representacion.html">
     7.3. Representación de ecuaciones simultáneas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../07-sem/04-identificacion.html">
     7.4. Identificación
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../07-sem/05-recursivo.html">
     7.5. El modelo recursivo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../07-sem/06-error.html">
     7.6. El término de error
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../07-sem/07-estimacion.html">
     7.7. Estimación
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../07-sem/refs.html">
     7.8. Referencias
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../08-var/chapter08.html">
   8. Vectores Auto-Regresivos (VAR)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../08-var/01-representaciones.html">
     8.1. Representaciones alternativas de un VAR
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08-var/02-dinamica.html">
     8.2. Dinámica de un VAR
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08-var/03-estimacion.html">
     8.3. Estimación
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08-var/04-pronostico.html">
     8.4. Pronósticos con VAR
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08-var/refs.html">
     8.5. Referencias
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Laboratorios
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../labs/chapter01.html">
   1. Introducción al análisis de series de tiempo
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/Componentes-IMAE.html">
     1.1. Descomposición del IMAE por componentes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/correlogram.html">
     1.2. Autocorrelograma y pruebas de ruido blanco para el IMAE de Costa Rica
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/covariance-stationarity-3d-plots.html">
     1.3. Ilustrando la diferencia entre serie de tiempo y proceso estocástico, estacionario y no estacionario
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/LandD.html">
     1.4. El operador de rezagos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/Transforme.html">
     1.5. Cálculo de transformaciones de la serie del PIB de Costa Rica
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/wntestq.html">
     1.6. Las pruebas de Box-Pierce y Ljung-Box.
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../labs/chapter02.html">
   2. Ecuaciones en diferencia
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/EqDiff2.html">
     2.1. Resolviendo una ecuación en diferencia con
     <code class="docutils literal notranslate">
      <span class="pre">
       sympy
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../labs/chapter03.html">
   3. Modelos AutoRegresivos de Media Móvil (ARMA)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/ISI-AR3.html">
     3.1. Estimación de un modelo ARMA de inflación para Costa Rica
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/demandadinero.html">
     3.2. Estimación de la demanda de dinero
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../labs/chapter04.html">
   4. Modelos de tendencia
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/DickeyFuller.html">
     4.1. Replicando el trabajo de Dickey y Fuller
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/GrangerNewbold.html">
     4.2. Replicando el trabajo de Granger y Newbold 1974
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/KPSS.html">
     4.3. Replicando el trabajo de KPSS (1992)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/NelsonPlosser.html">
     4.4. Replicando el trabajo de Nelson y Plosser (1982)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/tendencias-pib.html">
     4.5. Pruebas de raíz unitaria para el PIB en Costa Rica
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/tendencias-simulaciones.html">
     4.6. Series integradas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../labs/chapter05.html">
   5. Cambio estructural
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../labs/chapter06.html">
   6. Modelos de estacionalidad
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/SJO-pasajeros.html">
     6.1. Estacionalidad del número de pasajeros del aeropuerto Juan Santamaría
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../labs/chapter07.html">
   7. Sistemas de ecuaciones simultáneas
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/Klein%20model.html">
     7.1. Estimación del modelo I de Klein por Mínimos Cuadrados en 2 etapas (2SLS)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/telara%C3%B1a.html">
     7.2. El modelo de la telaraña
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../labs/chapter08.html">
   8. Vectores Auto-Regresivos (VAR)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/Simulacion%20de%20un%20VAR.html">
     8.1. Simulación de un VAR(1)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/VAR%20insesgado%20y%20consistente.html">
     8.2. Estimador OLS del VAR(1) es consistente e insesgado
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/VAR%20politica%20monetaria%20CR.html">
     8.3. Estimación de un VAR de la política monetaria de Costa Rica
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/VAR%281%29%20clase.html">
     8.4. Una clase para representar un VAR(1)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../labs/chapter09.html">
   9. Cointegración y VECM
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
  <label for="toctree-checkbox-16">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/Relaci%C3%B3n%20espuria.html">
     9.1. Regresión espuria
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/MacKinnon%20valores%20cr%C3%ADticos%20para%20test%20de%20cointegraci%C3%B3n.html">
     9.2. Valores críticos de MacKinnon para test de cointegración
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Apéndices
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../apendices/py-intro/py-chapter.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
  <label for="toctree-checkbox-17">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apendices/py-intro/Python-01--Para%20qu%C3%A9%20aprender%20Python.html">
     Introducción a Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apendices/py-intro/Python-02--Variables%20y%20operaciones%20b%C3%A1sicas.html">
     Variables y operaciones básicas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apendices/py-intro/Python-03--Textos.html">
     Manipulando Textos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apendices/py-intro/Python-04--Colecciones.html">
     Colecciones
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apendices/py-intro/Python-05--Control%20de%20ejecuci%C3%B3n.html">
     Control de ejecución
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apendices/py-intro/Python-06--Funciones.html">
     Funciones
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apendices/py-intro/Python-07--M%C3%B3dulos.html">
     Módulos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apendices/py-intro/Python-08--Clases%20y%20objetos.html">
     Clases y objetos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apendices/py-intro/Python-09--manipulando-datos.html">
     Importando y manipulando datos con Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apendices/py-intro/Python-10--Webscraping.html">
     Web scraping con BeautifulSoup
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apendices/py-intro/Python-11--Leyendo-archivos-XML.html">
     Leyendo archivos XML
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../apendices/r-code/chapter-r.html">
   Código en R
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
  <label for="toctree-checkbox-18">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apendices/r-code/R-transform.html">
     Transformaciones con R
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apendices/r-code/R-lags.html">
     Rezagos con R
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apendices/r-code/R-correlogram.html">
     Correlogramas con R
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../apendices/matematica/matematica.html">
   Matemática
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
  <label for="toctree-checkbox-19">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apendices/matematica/01-algebra-lineal.html">
     Álgebra lineal
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apendices/matematica/02-numeros-complejos.html">
     Números complejos
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../apendices/estadistica/estadistica.html">
   Estadística y econometría
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
  <label for="toctree-checkbox-20">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apendices/estadistica/01-estadistica.html">
     Resultados de teoría estadística
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apendices/estadistica/02-econometria.html">
     Resultados de econometría
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apendices/estadistica/Futbol-Bernoulli-Teorema-L%C3%ADmite-Central.html">
     Ilustración del Teorema del Límite Central
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  <a href="http://randall-romero.com">randall-romero.com</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../../_sources/teoria/06-estacional/02-sarima.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/teoria/06-estacional/02-sarima.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/randall-romero/econometria/master?urlpath=lab/tree/./teoria/06-estacional/02-sarima.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#un-modelo-estacional-puro">
   Un modelo estacional puro
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#diferenciacion-estacional">
   Diferenciación estacional
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#un-modelo-arima-para-observaciones-de-la-misma-estacion">
   Un modelo ARIMA para observaciones de la misma estación
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#el-modelo-sarima">
   El modelo SARIMA
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#identificacion-de-un-modelo-sarima">
   Identificación de un modelo SARIMA
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pronosticando-un-modelo-sarima">
   Pronosticando un modelo SARIMA
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Modelo ARIMA estacional</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#un-modelo-estacional-puro">
   Un modelo estacional puro
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#diferenciacion-estacional">
   Diferenciación estacional
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#un-modelo-arima-para-observaciones-de-la-misma-estacion">
   Un modelo ARIMA para observaciones de la misma estación
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#el-modelo-sarima">
   El modelo SARIMA
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#identificacion-de-un-modelo-sarima">
   Identificación de un modelo SARIMA
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pronosticando-un-modelo-sarima">
   Pronosticando un modelo SARIMA
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\require{color}
\newcommand{\alert}[1]{{\color{RedOrange} #1}}
\newcommand{\notation}[2]{\underset{\color{MidnightBlue}\text{#2}}{#1}}
\newcommand{\simbolo}[2]{\underset{\color{MidnightBlue}#2}{#1}}
\newcommand{\notationbrace}[2]{{\underbrace{#1}_{\color{MidnightBlue}\text{#2}}}}
\DeclareMathOperator{\dd}{\,d\!}
\DeclareMathOperator{\E}{\mathbb{E}{}}
\DeclareMathOperator{\Var}{Var{}}
\DeclareMathOperator{\Cov}{Cov{}}
\DeclareMathOperator{\Lag}{L{}}
\DeclareMathOperator*{\argmin}{argmin}
\DeclareMathOperator*{\argmax}{argmax}
\DeclareMathOperator{\Prob}{\mathbb{P}}
\newcommand{\marginal}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\MAT}[1]{\begin{bmatrix} #1 \end{bmatrix}}
\newcommand{\mat}[1]{\left[\begin{smallmatrix} #1 \end{smallmatrix}\right]}\\\begin{split}\DeclareMathOperator{\R}{\mathbb{R}}
\DeclareMathOperator{\X}{\mathbf{x}}
\DeclareMathOperator{\y}{\mathbf{y}}
\DeclareMathOperator{\h}{\mathbf{h}}
\newcommand{\stackEq}[1]{\MAT{#1_1 \\ #1_2 \\ \vdots \\ #1_M}}
\newcommand{\e}{\mathbf{\epsilon}}
\newcommand{\Y}{\mathbf{Y}}
\newcommand{\estimator}[2]{{\hat{#1}^{\text{#2}}}}
\newcommand{\estimate}[2]{\underset{(#2)}{#1}}
\DeclareMathOperator{\plim}{plim}
\newcommand{\PLIM}[2]{#1\xrightarrow{p} #2}\end{split}\end{aligned}\end{align} \]</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn-talk&#39;</span><span class="p">)</span>


<span class="kn">from</span> <span class="nn">statsmodels.graphics.tsaplots</span> <span class="kn">import</span> <span class="n">plot_acf</span><span class="p">,</span> <span class="n">plot_pacf</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.statespace.sarimax</span> <span class="kn">import</span> <span class="n">SARIMAX</span>
</pre></div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="modelo-arima-estacional">
<h1><span class="section-number">6.2. </span>Modelo ARIMA estacional<a class="headerlink" href="#modelo-arima-estacional" title="Permalink to this headline">¶</a></h1>
<p>En un modelo ARIMA estacional, términos AR y MA predicen <span class="math notranslate nohighlight">\( y_{t} \)</span> usando valores de datos y errores con rezagos  que son múltiplos de <span class="math notranslate nohighlight">\(s\)</span></p>
<p>Por ejemplo, con datos trimestrales (s=4),</p>
<ul class="simple">
<li><p>un modelo autorregresivo estacional de primer orden usa <span class="math notranslate nohighlight">\(y_{t-4}\)</span> para predecir <span class="math notranslate nohighlight">\(y_{t}\)</span>, mientras que uno de segundo orden usa <span class="math notranslate nohighlight">\(y_{t-4}, y_{t-8}\)</span> para ello.</p></li>
<li><p>un modelo de media móvil estacional de primer orden usa <span class="math notranslate nohighlight">\(\epsilon_{t-4}\)</span> para predecir <span class="math notranslate nohighlight">\(y_{t}\)</span>, mientras que uno de segundo orden utiliza <span class="math notranslate nohighlight">\(\epsilon_{t-4}, \epsilon_{t-8}\)</span>.</p></li>
</ul>
<p>Por ejemplo, si quisiéramos pronosticar el número de pasajeros extranjeros que viajarán por el SJO en agosto 2020, tiene mucho sentido modelar ese valor en función del número de pasajeros extranjeros que viajaron por SJO en agosto de años anteriores.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># read data from previous example</span>

<span class="n">sjodatos</span> <span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s2">&quot;datos/SJO-pasajeros.pickle&quot;</span><span class="p">)</span>
<span class="n">sjodatoscuadro</span> <span class="o">=</span> <span class="n">sjodatos</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
<span class="n">sjodatoscuadro</span><span class="p">[</span><span class="s1">&#39;extranjeros&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="un-modelo-estacional-puro">
<h2>Un modelo estacional puro<a class="headerlink" href="#un-modelo-estacional-puro" title="Permalink to this headline">¶</a></h2>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:right head"><p>Año</p></th>
<th class="text-align:right head"><p>May</p></th>
<th class="text-align:right head"><p>Jun</p></th>
<th class="text-align:right head"><p>Jul</p></th>
<th class="text-align:right head"><p>Ago</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:right"><p>2016</p></td>
<td class="text-align:right"><p></p></td>
<td class="text-align:right"><p></p></td>
<td class="text-align:right"><p></p></td>
<td class="text-align:right"><p><span class="math notranslate nohighlight">\(y_{t-36}=138.7\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p>2017</p></td>
<td class="text-align:right"><p></p></td>
<td class="text-align:right"><p></p></td>
<td class="text-align:right"><p></p></td>
<td class="text-align:right"><p><span class="math notranslate nohighlight">\(y_{t-24}=142.8\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-align:right"><p>2018</p></td>
<td class="text-align:right"><p></p></td>
<td class="text-align:right"><p></p></td>
<td class="text-align:right"><p></p></td>
<td class="text-align:right"><p><span class="math notranslate nohighlight">\(y_{t-12}=156.0\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p>2019</p></td>
<td class="text-align:right"><p><span class="math notranslate nohighlight">\(y_{t-3}=128.2\)</span></p></td>
<td class="text-align:right"><p><span class="math notranslate nohighlight">\(y_{t-2}=137.0\)</span></p></td>
<td class="text-align:right"><p><span class="math notranslate nohighlight">\(y_{t-1}=151.4\)</span></p></td>
<td class="text-align:right"><p><span class="math notranslate nohighlight">\(y_{t}=156.4\)</span></p></td>
</tr>
</tbody>
</table>
<p>En general, un modelo puramente estacional puede representarse por</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{multline*}
y_t = \varphi_1y_{t-s} + \varphi_2y_{t-2s} + \dots+ \varphi_Py_{t-Ps} +\\
+ \varepsilon_t + \vartheta_{1}\varepsilon_{t-s} + \vartheta_{2}\varepsilon_{t-2s} + \dots + \vartheta_{Q}\varepsilon_{t-Qs}
\end{multline*}\]</div>
<p>o bien, en términos de polinomios de rezagos</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\notationbrace{\left(1 - \varphi_1\Lag^{s} - \dots - \varphi_P\Lag^{Ps} \right)}{$\varPhi(\Lag^s)$}y_{t} = \notationbrace{\left(1 + \vartheta_{1}\Lag^{s}+\dots+\vartheta_{Q}\Lag^{Qs}\right)}{$\varTheta(\Lag^s)$}\varepsilon_{t}
\end{equation*}\]</div>
</div>
<div class="section" id="diferenciacion-estacional">
<h2>Diferenciación estacional<a class="headerlink" href="#diferenciacion-estacional" title="Permalink to this headline">¶</a></h2>
<p>La diferenciación estacional se define como la diferencia entre un valor <span class="math notranslate nohighlight">\( y_{t} \)</span> y un valor rezagado un múltiplo de <span class="math notranslate nohighlight">\(s\)</span> períodos.</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\Delta_{s} y_{t} = \left(1-\Lag^{s}\right)y_t = y_t - y_{t-s}
\end{equation*}\]</div>
<p>Por ejemplo:
trimestral
:   <span class="math notranslate nohighlight">\(\Delta_{4} y_{t} = \left(1-\Lag^{4}\right)y_t = y_t - y_{t-4}\)</span></p>
<dl class="simple myst">
<dt>mensual</dt><dd><p><span class="math notranslate nohighlight">\(\Delta_{12} y_{t} = \left(1-\Lag^{12}\right)y_t = y_t - y_{t-12}\)</span></p>
</dd>
</dl>
<p>Nótese que siguiendo esta notación <span class="math notranslate nohighlight">\( \Delta y_t = \Delta_1 y_t \)</span>. Pero</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
              \Delta_2 y_t &amp;\neq \Delta^2 y_t \\
\left(1 - \Lag^2\right)y_t &amp;\neq \left(1-\Lag\right)^2y_t \\
\left(1 - \Lag^2\right)y_t &amp;\neq \left(1-2\Lag + \Lag^2\right)y_t \\
              y_t- y_{t-2} &amp;\neq y_t - 2y_{t-1} + y_{t-2}
\end{align*}\]</div>
</div>
</div>
<div class="section" id="un-modelo-arima-para-observaciones-de-la-misma-estacion">
<h2>Un modelo ARIMA para observaciones de la misma estación<a class="headerlink" href="#un-modelo-arima-para-observaciones-de-la-misma-estacion" title="Permalink to this headline">¶</a></h2>
<p>En general, podríamos plantear un modelo ARIMA para observaciones de una sola estación (mes, trimestre)</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\varPhi(\Lag^s)\Delta_s^D y_t = \varTheta(\Lag^s)\varepsilon_{t}
\end{equation*}\]</div>
<p>Es usualmente razonable asumir que esta misma relación la cumplen las observaciones de la estación anterior</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\varPhi(\Lag^s)\Delta_s^D y_{t-1} = \varTheta(\Lag^s)\varepsilon_{t-1}
\end{equation*}\]</div>
<p>En general, los errores de estas relaciones <span class="math notranslate nohighlight">\(\varepsilon_{t}, \varepsilon_{t-1}\)</span> podrían estar correlacionadas, por lo que en principio podemos plantear el modelo ARIMA:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\Phi(\Lag)\Delta^d \varepsilon_{t} = \Theta(\Lag)\epsilon_{t}
\end{equation*}\]</div>
<p>donde <span class="math notranslate nohighlight">\(\epsilon_{t}\)</span> es ruido blanco.</p>
</div>
<div class="section" id="el-modelo-sarima">
<h2>El modelo SARIMA<a class="headerlink" href="#el-modelo-sarima" title="Permalink to this headline">¶</a></h2>
<p>Asumiendo que el proceso ARIMA de cada estación es invertible obtenemos</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
     \varPhi(\Lag^s)\Delta_s^D y_t &amp;= \varTheta(\Lag^s)\varepsilon_{t}\\
\varTheta^{-1}(\Lag^s)\varPhi(\Lag^s)\Delta_s^D y_t &amp;= \varepsilon_{t}\\
\Phi(\Lag)\Delta^d\varTheta^{-1}(\Lag^s)\varPhi(\Lag^s)\Delta_s^D y_t &amp;= \Phi(\Lag)\Delta^d\varepsilon_{t}\\
                    &amp;= \Theta(\Lag)\epsilon_{t} \\
\notation{\Phi(\Lag)}{$p$}\notation{\varPhi(\Lag^s)}{$P$}\notation{\Delta^d_{\phantom{D}}}{$d$}\notation{\Delta_s^D}{$D$} y_t &amp;= \notation{\Theta(\Lag)}{$q$}\notation{\varTheta(\Lag^s)}{$Q$}\epsilon_{t}
\end{align*}\]</div>
<p>Este modelo se denomina <span class="math notranslate nohighlight">\(\alert{\text{SARIMA}(p,d,q)\times(P,D,Q)_s}\)</span>.</p>
<p><div class="ejemplo">
<div class="ejemplo-titulo"><b>Ejemplo:  
 Algunos modelos SARIMA </b></div></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\text{SARIMA}(0,0,0)\times(0,1,0)_4 = \text{SARIMA}(0,1,0)_4\)</span></p></li>
</ul>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\Delta_4 y_t &amp;= \epsilon_{t} \\
(1-\Lag^4) y_t &amp;= \epsilon_{t} \\
y_{t} - y_{t-4} &amp;= \epsilon_{t}
\end{align*}\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\text{SARIMA}(2,0,0)_4 = \text{SAR}(2)_4\)</span></p></li>
</ul>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\left(1-\varphi_1\Lag^4-\varphi_2\Lag^8\right) y_t &amp;= \epsilon_{t} \\
y_{t} - \varphi_1y_{t-4} - \varphi_2y_{t-8} &amp;= \epsilon_{t}
\end{align*}\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\text{SARIMA}(0,0,3)_4 = \text{SMA}(3)_4\)</span></p></li>
</ul>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
y_t &amp;= (1+\vartheta_1\Lag^4 +\vartheta_2\Lag^8 + \vartheta_3\Lag^{12})\epsilon_{t} \\
    &amp;= \epsilon_{t} + \vartheta_1\epsilon_{t-4} +\vartheta_2\epsilon_{t-8} + \vartheta_3\epsilon_{t-12}
\end{align*}\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\text{SARIMA}(0,1,1)\times(0,1,1)_4\)</span></p></li>
</ul>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\Delta \Delta_4 y_t &amp;= (1+\theta\Lag)(1+\vartheta\Lag^4 )\epsilon_{t} \\
(1-\Lag)(1-\Lag^4) y_t &amp;= (1+\theta\Lag)(1+\vartheta\Lag^4 )\epsilon_{t} \\
(1-\Lag -\Lag^4 + \Lag^5) y_t &amp;= (1+\theta\Lag +\vartheta\Lag^4 +\theta\vartheta\Lag^5)\epsilon_{t} \\
y_{t} - y_{t-1} - y_{t-4} + y_{t-5} &amp;= \epsilon_{t} + \theta\epsilon_{t-1} + \vartheta\epsilon_{t-4} + \theta\vartheta\epsilon_{t-5}
\end{align*}\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\text{SARIMA}(1,0,0)\times(0,1,1)_4\)</span></p></li>
</ul>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
(1-\phi\Lag) \Delta_4 y_t &amp;= (1+\vartheta\Lag^4 )\epsilon_{t} \\
(1-\phi\Lag)(1-\Lag^4) y_t &amp;= (1+\vartheta\Lag^4 )\epsilon_{t} \\
(1-\phi\Lag -\Lag^4 + \phi\Lag^5) y_t &amp;= (1+\vartheta\Lag^4 )\epsilon_{t} \\
y_{t} - \phi y_{t-1} - y_{t-4} + \phi y_{t-5} &amp;= \epsilon_{t} + \vartheta\epsilon_{t-4}
\end{align*}\]</div>
</div>
</div>
<div class="section" id="identificacion-de-un-modelo-sarima">
<h2>Identificación de un modelo SARIMA<a class="headerlink" href="#identificacion-de-un-modelo-sarima" title="Permalink to this headline">¶</a></h2>
<p>La identificación de modelos estacionales es más difícil que la identificación de modelos no estacionales por dos razones:</p>
<ol class="simple">
<li><p>Muchas series estacionales exhiben también patrones no estacionales y por lo tanto las FAC y las FACP estimadas contienen ambos patrones.</p></li>
<li><p>No hay muchas correlaciones en valores <span class="math notranslate nohighlight">\(k\)</span> múltiplos de <span class="math notranslate nohighlight">\(s\)</span>. Por ejemplo, en una serie mensual podríamos contar únicamente con <span class="math notranslate nohighlight">\(k = 12\)</span>, <span class="math notranslate nohighlight">\(k = 24\)</span> y <span class="math notranslate nohighlight">\(k = 36\)</span></p></li>
</ol>
<p>En la práctica, cuando se tienen dudas, se utilizan herramientas que automatizan esta selección de parámetros a partir de criterios de selección.</p>
<p><div class="ejemplo">
<div class="ejemplo-titulo"><b>Ejemplo:  
 Estimación de un modelo SARIMA </b></div></p>
<p>El correlograma de la serie de movimientos de pasajeros extranjeros en SJO sugiere que la serie tiene un componente estacional.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">correlogramas4</span><span class="p">(</span><span class="n">serie</span><span class="p">,</span> <span class="n">residencia</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">opts</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">func</span> <span class="ow">is</span> <span class="n">plot_pacf</span><span class="p">:</span>
        <span class="n">opts</span><span class="p">[</span><span class="s1">&#39;method&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;ols&#39;</span>

    <span class="n">func</span><span class="p">(</span><span class="n">serie</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;$y_t$&#39;</span><span class="p">);</span>
    <span class="n">func</span><span class="p">(</span><span class="n">serie</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="o">**</span><span class="n">opts</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;$\Delta y_t$&#39;</span><span class="p">);</span>
    <span class="n">func</span><span class="p">(</span><span class="n">serie</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="o">**</span><span class="n">opts</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;$\Delta_</span><span class="si">{12}</span><span class="s1">y_t$&#39;</span><span class="p">);</span>
    <span class="n">func</span><span class="p">(</span><span class="n">serie</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="o">**</span><span class="n">opts</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;$\Delta\Delta_</span><span class="si">{12}</span><span class="s1">y_t$&#39;</span><span class="p">);</span>

    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="o">.</span><span class="n">flat</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">24.5</span><span class="p">],</span> <span class="n">xticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

    <span class="n">pp</span> <span class="o">=</span> <span class="s1">&#39;parcial&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">func</span> <span class="ow">is</span> <span class="n">plot_pacf</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Correlogramas </span><span class="si">{</span><span class="n">pp</span><span class="si">}</span><span class="s1"> de cantidad de pasajeros </span><span class="si">{</span><span class="n">residencia</span><span class="si">}</span><span class="s1"> en SJO&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span>

<span class="n">extranjeros</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sjodatos</span><span class="p">[</span><span class="s1">&#39;extranjeros&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">period_range</span><span class="p">(</span><span class="s1">&#39;2011-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-12&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">))</span>
<span class="n">correlogramas4</span><span class="p">(</span><span class="n">extranjeros</span><span class="p">,</span> <span class="s1">&#39;extranjeros&#39;</span><span class="p">,</span> <span class="n">plot_acf</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>Al usar una herramienta de selección de modelos <code class="docutils literal notranslate"><span class="pre">statsmodels.tsa.x13.x13_arima_select_order</span></code> en Python se selecciona el modelo <span class="math notranslate nohighlight">\(\text{SARIMA}(0, 1, 1)\times(0, 1, 1)_{12}\)</span>.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mod_extranjeros</span> <span class="o">=</span> <span class="n">SARIMAX</span><span class="p">(</span><span class="n">extranjeros</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">seasonal_order</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">mod_extranjeros</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>El modelo estimado es</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
(1-\Lag)(1-\Lag^{12}) y_t &amp;= (1-0.611\Lag)(1-0.765\Lag^{12} )\epsilon_{t} \\
y_{t} - y_{t-1} - y_{t-12} + y_{t-13} &amp;= \epsilon_{t} - 0.611\epsilon_{t-1} -0.765\epsilon_{t-12} + 0.467\epsilon_{t-13}
\end{align*}\]</div>
<p>Los resultados de la tabla anterior muestran que:</p>
<ul class="simple">
<li><p>Los coeficiente estimados son significativos.</p></li>
<li><p>Los residuos del modelo…</p>
<ul>
<li><p>parecen no estar autocorrelacionados: el valor <span class="math notranslate nohighlight">\(p\)</span> del estadístico <span class="math notranslate nohighlight">\(Q\)</span> de Lung-Box es 0.19.</p></li>
<li><p>parecen ser normales: la asimetría es 0.09, la kurtosis es 3.16, y el valor <span class="math notranslate nohighlight">\(p\)</span> de la prueba de Jarque-Bera es 0.89.</p></li>
</ul>
</li>
</ul>
<p>Por ello, podemos pensar que el modelo estimado es una buena representación de los datos.</p>
<p>La expresión</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
y_{t} = y_{t-1} + y_{t-12} - y_{t-13} + \epsilon_{t} - 0.611\epsilon_{t-1} -0.765\epsilon_{t-4} + 0.467\epsilon_{t-5}
\end{equation*}\]</div>
<p>puede utilizarse recursivamente para generar pronósticos.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_forecast</span><span class="p">(</span><span class="n">modelo</span><span class="p">,</span> <span class="n">serie</span><span class="p">,</span> <span class="n">residencia</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
    <span class="n">fcast</span> <span class="o">=</span> <span class="n">modelo</span><span class="o">.</span><span class="n">get_forecast</span><span class="p">(</span><span class="s1">&#39;2020-12&#39;</span><span class="p">)</span>
    <span class="n">ci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">fcast</span><span class="o">.</span><span class="n">conf_int</span><span class="p">())</span>
    <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">fcast</span><span class="o">.</span><span class="n">predicted_mean</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">ci</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="s1">&#39;lower y&#39;</span><span class="p">,</span> <span class="s1">&#39;upper y&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ci</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>    
    <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">serie</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Pronóstico de pasajeros </span><span class="si">{</span><span class="n">residencia</span><span class="si">}</span><span class="s1"> en aeropuerto SJO&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">plot_forecast</span><span class="p">(</span><span class="n">mod_extranjeros</span><span class="p">,</span> <span class="n">extranjeros</span><span class="p">[</span><span class="s1">&#39;2015&#39;</span><span class="p">:],</span> <span class="s1">&#39;extranjeros&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;miles de pasajeros&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="pronosticando-un-modelo-sarima">
<h2>Pronosticando un modelo SARIMA<a class="headerlink" href="#pronosticando-un-modelo-sarima" title="Permalink to this headline">¶</a></h2>
<p>Si expandimos los polinomios del proceso <span class="math notranslate nohighlight">\(\text{SARIMA}(p,d,q)\times(P,D,Q)_s\)</span></p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\notation{\Phi(\Lag)}{$p$}\notation{\varPhi(\Lag^s)}{$P$}\notation{\Delta^d_{\phantom{D}}}{$d$}\notation{\Delta_s^D}{$D$} y_t = \notation{\Theta(\Lag)}{$q$}\notation{\varTheta(\Lag^s)}{$Q$}\epsilon_{t}
\end{equation*}\]</div>
<p>el resultado será un polinomio de grado <span class="math notranslate nohighlight">\(p+Ps+d+D\)</span> del lado izquierdo y uno de grado <span class="math notranslate nohighlight">\(q+Qs\)</span> del lado derecho.</p>
<p>Para horizontes de más allá de <span class="math notranslate nohighlight">\(q+Qs\)</span> períodos, la dinámica de estos pronósticos estará gobernada únicamente por la ecuación en diferencia homogénea</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\Phi(\Lag)\varPhi(\Lag^s)\Delta^d\Delta_s^D \hat{y}_{t+h} = 0
\end{equation*}\]</div>
<p><img alt="sarima-forecast-paterns" src="../../_images/sarima-forecast-patterns.png" /></p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./teoria\06-estacional"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="01-intro.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">6.1. </span>Introducción</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="03-x13arima.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">6.3. </span>Ajuste estacional</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Randall Romero Aguilar<br/>
    
        &copy; Copyright 2021-2022.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>