
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>4.4. Detectando raíces unitarias &#8212; Apuntes de Macroeconometría</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mi-estilo.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="canonical" href="https://randall-romero.github.io/econometria/teoria/04-arima/04-pruebas.html" />
    <link rel="shortcut icon" href="../../_static/r2-logo-icon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="4.5. El filtro de Hodrick y Prescott" href="05-hp.html" />
    <link rel="prev" title="4.3. Series con raíz unitaria y procesos ARIMA" href="03-raices-unitarias.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-57200532-3', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/r2-logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Apuntes de Macroeconometría</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../00-acerca.html">
                    Inicio
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Acerca de este libro
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../01-interactuando.html">
   Cómo interactuar con este libro
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../02-contenido.html">
   Tipo de contenido
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Teoría
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../01-intro/chapter01.html">
   1. Introducción al análisis de series de tiempo
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-intro/01-historia.html">
     1.1. Una breve historia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-intro/02-graficos.html">
     1.2. Representación gráfica de series de tiempo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-intro/03-rezagos.html">
     1.3. El operador de rezagos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-intro/04-procesos-estocasticos.html">
     1.4. Procesos estocásticos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-intro/05-series-tiempo.html">
     1.5. Series de tiempo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-intro/06-pruebas.html">
     1.6. Pruebas de series de tiempo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-intro/refs.html">
     1.7. Referencias
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../02-eqdiff/chapter02.html">
   2. Ecuaciones en diferencia
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-eqdiff/01-intro.html">
     2.1. Acerca de este capítulo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-eqdiff/02-sustitucion.html">
     2.2. Solución por sustituciones recursivas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-eqdiff/03-combinacion.html">
     2.3. Solución por combinación de soluciones homogéneas y particulares
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-eqdiff/04-operador.html">
     2.4. Solución por medio del operador de rezagos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-eqdiff/refs.html">
     2.5. Referencias
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../03-arma/chapter03.html">
   3. Modelos AutoRegresivos de Media Móvil (ARMA)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-arma/01-intro.html">
     3.1. Introducción
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-arma/02-MA.html">
     3.2. Proceso de media móvil MA(q)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-arma/03-AR.html">
     3.3. Proceso autorregresivo AR(p)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-arma/04-ARMA.html">
     3.4. Proceso autorregresivo de media móvil ARMA(p,q)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-arma/05-estimacion.html">
     3.5. Estimación de modelos ARMA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-arma/06-pronosticos.html">
     3.6. Pronósticos con modelos ARMA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-arma/refs.html">
     3.7. Referencias
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="chapter04.html">
   4. Modelos de tendencia
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01-modelos-tendencia.html">
     4.1. Modelos de series con tendencia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02-removiendo.html">
     4.2. Removiendo una tendencia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03-raices-unitarias.html">
     4.3. Series con raíz unitaria y procesos ARIMA
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     4.4. Detectando raíces unitarias
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="05-hp.html">
     4.5. El filtro de Hodrick y Prescott
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="refs.html">
     4.6. Referencias
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../05-cambioestructural/chapter05.html">
   5. Cambio estructural
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../05-cambioestructural/01-chow.html">
     5.1. La prueba de Chow
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05-cambioestructural/02-conocido.html">
     5.2. Cambio estructural y raíces unitarias: fecha conocida
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05-cambioestructural/03-desconocido.html">
     5.3. Cambio estructural y raíces unitarias: fecha desconocida
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05-cambioestructural/refs.html">
     5.4. Referencias
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../06-estacional/chapter06.html">
   6. Modelos de estacionalidad
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../06-estacional/01-intro.html">
     6.1. Introducción
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06-estacional/02-sarima.html">
     6.2. Modelo ARIMA estacional
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06-estacional/03-x13arima.html">
     6.3. Ajuste estacional
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06-estacional/04-raices-unitarias.html">
     6.4. Raíces unitarias estacionales
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06-estacional/refs.html">
     6.5. Referencias
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../07-sem/chapter07.html">
   7. Sistemas de ecuaciones simultáneas
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../07-sem/01-motivacion.html">
     7.1. Motivación
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../07-sem/02-sur.html">
     7.2. El modelo SUR
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../07-sem/03-representacion.html">
     7.3. Representación de ecuaciones simultáneas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../07-sem/04-identificacion.html">
     7.4. Identificación
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../07-sem/05-recursivo.html">
     7.5. El modelo recursivo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../07-sem/06-error.html">
     7.6. El término de error
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../07-sem/07-estimacion.html">
     7.7. Estimación
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../07-sem/refs.html">
     7.8. Referencias
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../08-var/chapter08.html">
   8. Vectores Auto-Regresivos (VAR)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../08-var/01-representaciones.html">
     8.1. Representaciones alternativas de un VAR
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08-var/02-dinamica.html">
     8.2. Dinámica de un VAR
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08-var/03-estimacion.html">
     8.3. Estimación
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08-var/04-pronostico.html">
     8.4. Pronósticos con VAR
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08-var/refs.html">
     8.5. Referencias
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Laboratorios
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../labs/chapter01.html">
   1. Introducción al análisis de series de tiempo
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/Componentes-IMAE.html">
     1.1. Descomposición del IMAE por componentes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/correlogram.html">
     1.2. Autocorrelograma y pruebas de ruido blanco para el IMAE de Costa Rica
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/covariance-stationarity-3d-plots.html">
     1.3. Ilustrando la diferencia entre serie de tiempo y proceso estocástico, estacionario y no estacionario
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/LandD.html">
     1.4. El operador de rezagos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/Transforme.html">
     1.5. Cálculo de transformaciones de la serie del PIB de Costa Rica
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/wntestq.html">
     1.6. Las pruebas de Box-Pierce y Ljung-Box.
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../labs/chapter02.html">
   2. Ecuaciones en diferencia
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/EqDiff2.html">
     2.1. Resolviendo una ecuación en diferencia con
     <code class="docutils literal notranslate">
      <span class="pre">
       sympy
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../labs/chapter03.html">
   3. Modelos AutoRegresivos de Media Móvil (ARMA)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/ISI-AR3.html">
     3.1. Estimación de un modelo ARMA de inflación para Costa Rica
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/demandadinero.html">
     3.2. Estimación de la demanda de dinero
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../labs/chapter04.html">
   4. Modelos de tendencia
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/DickeyFuller.html">
     4.1. Replicando el trabajo de Dickey y Fuller
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/GrangerNewbold.html">
     4.2. Replicando el trabajo de Granger y Newbold 1974
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/KPSS.html">
     4.3. Replicando el trabajo de KPSS (1992)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/NelsonPlosser.html">
     4.4. Replicando el trabajo de Nelson y Plosser (1982)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/tendencias-pib.html">
     4.5. Pruebas de raíz unitaria para el PIB en Costa Rica
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/tendencias-simulaciones.html">
     4.6. Series integradas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../labs/chapter05.html">
   5. Cambio estructural
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../labs/chapter06.html">
   6. Modelos de estacionalidad
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/SJO-pasajeros.html">
     6.1. Estacionalidad del número de pasajeros del aeropuerto Juan Santamaría
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../labs/chapter07.html">
   7. Sistemas de ecuaciones simultáneas
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/Klein%20model.html">
     7.1. Estimación del modelo I de Klein por Mínimos Cuadrados en 2 etapas (2SLS)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/telara%C3%B1a.html">
     7.2. El modelo de la telaraña
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../labs/chapter08.html">
   8. Vectores Auto-Regresivos (VAR)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/Simulacion%20de%20un%20VAR.html">
     8.1. Simulación de un VAR(1)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/VAR%20insesgado%20y%20consistente.html">
     8.2. Estimador OLS del VAR(1) es consistente e insesgado
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/VAR%20politica%20monetaria%20CR.html">
     8.3. Estimación de un VAR de la política monetaria de Costa Rica
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/VAR%281%29%20clase.html">
     8.4. Una clase para representar un VAR(1)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../labs/chapter09.html">
   9. Cointegración y VECM
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
  <label for="toctree-checkbox-16">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/Relaci%C3%B3n%20espuria.html">
     9.1. Regresión espuria
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../labs/MacKinnon%20valores%20cr%C3%ADticos%20para%20test%20de%20cointegraci%C3%B3n.html">
     9.2. Valores críticos de MacKinnon para test de cointegración
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Apéndices
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../apendices/py-intro/py-chapter.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
  <label for="toctree-checkbox-17">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apendices/py-intro/Python-01--Para%20qu%C3%A9%20aprender%20Python.html">
     Introducción a Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apendices/py-intro/Python-02--Variables%20y%20operaciones%20b%C3%A1sicas.html">
     Variables y operaciones básicas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apendices/py-intro/Python-03--Textos.html">
     Manipulando Textos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apendices/py-intro/Python-04--Colecciones.html">
     Colecciones
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apendices/py-intro/Python-05--Control%20de%20ejecuci%C3%B3n.html">
     Control de ejecución
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apendices/py-intro/Python-06--Funciones.html">
     Funciones
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apendices/py-intro/Python-07--M%C3%B3dulos.html">
     Módulos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apendices/py-intro/Python-08--Clases%20y%20objetos.html">
     Clases y objetos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apendices/py-intro/Python-09--manipulando-datos.html">
     Importando y manipulando datos con Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apendices/py-intro/Python-10--Webscraping.html">
     Web scraping con BeautifulSoup
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apendices/py-intro/Python-11--Leyendo-archivos-XML.html">
     Leyendo archivos XML
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../apendices/matematica/matematica.html">
   Matemática
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
  <label for="toctree-checkbox-18">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apendices/matematica/01-algebra-lineal.html">
     Álgebra lineal
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apendices/matematica/02-numeros-complejos.html">
     Números complejos
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../apendices/estadistica/estadistica.html">
   Estadística y econometría
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
  <label for="toctree-checkbox-19">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apendices/estadistica/01-estadistica.html">
     Resultados de teoría estadística
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apendices/estadistica/02-econometria.html">
     Resultados de econometría
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../apendices/estadistica/Futbol-Bernoulli-Teorema-L%C3%ADmite-Central.html">
     Ilustración del Teorema del Límite Central
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            <a href="http://randall-romero.com">randall-romero.com</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/randall-romero/econometria/master?urlpath=lab/tree/./teoria/04-arima/04-pruebas.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/randall-romero/econometria/blob/master/./teoria/04-arima/04-pruebas.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/teoria/04-arima/04-pruebas.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download notebook file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        <a href="../../_sources/teoria/04-arima/04-pruebas.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#la-prueba-dickey-fuller">
   La prueba Dickey-Fuller
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#la-distribucion-de-dickey-fuller">
   La distribución de Dickey-Fuller
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#la-prueba-aumentada-de-dickey-fuller">
   La prueba aumentada de Dickey-Fuller
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#interpretando-una-prueba-de-dickey-fuller">
   Interpretando una prueba de Dickey Fuller
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#potencia-de-la-distribucion-de-dickey-fuller">
   Potencia de la distribución de Dickey-Fuller
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#limitaciones-de-las-pruebas-de-raiz-unitaria">
   Limitaciones de las pruebas de raíz unitaria
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#la-prueba-kpss">
   La prueba KPSS
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Detectando raíces unitarias</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#la-prueba-dickey-fuller">
   La prueba Dickey-Fuller
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#la-distribucion-de-dickey-fuller">
   La distribución de Dickey-Fuller
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#la-prueba-aumentada-de-dickey-fuller">
   La prueba aumentada de Dickey-Fuller
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#interpretando-una-prueba-de-dickey-fuller">
   Interpretando una prueba de Dickey Fuller
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#potencia-de-la-distribucion-de-dickey-fuller">
   Potencia de la distribución de Dickey-Fuller
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#limitaciones-de-las-pruebas-de-raiz-unitaria">
   Limitaciones de las pruebas de raíz unitaria
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#la-prueba-kpss">
   La prueba KPSS
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\require{color}
\newcommand{\alert}[1]{{\color{RedOrange} #1}}
\newcommand{\notation}[2]{\underset{\color{MidnightBlue}\text{#2}}{#1}}
\newcommand{\simbolo}[2]{\underset{\color{MidnightBlue}#2}{#1}}
\newcommand{\notationbrace}[2]{{\underbrace{#1}_{\color{MidnightBlue}\text{#2}}}}
\DeclareMathOperator{\dd}{\,d\!}
\DeclareMathOperator{\E}{\mathbb{E}{}}
\DeclareMathOperator{\Var}{Var{}}
\DeclareMathOperator{\Cov}{Cov{}}
\DeclareMathOperator{\Lag}{L{}}
\DeclareMathOperator*{\argmin}{argmin}
\DeclareMathOperator*{\argmax}{argmax}
\DeclareMathOperator{\Prob}{\mathbb{P}}
\newcommand{\marginal}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\MAT}[1]{\begin{bmatrix} #1 \end{bmatrix}}
\newcommand{\mat}[1]{\left[\begin{smallmatrix} #1 \end{smallmatrix}\right]}\\\begin{split}\DeclareMathOperator{\R}{\mathbb{R}}
\DeclareMathOperator{\X}{\mathbf{x}}
\DeclareMathOperator{\y}{\mathbf{y}}
\DeclareMathOperator{\h}{\mathbf{h}}
\newcommand{\stackEq}[1]{\MAT{#1_1 \\ #1_2 \\ \vdots \\ #1_M}}
\newcommand{\e}{\mathbf{\epsilon}}
\newcommand{\Y}{\mathbf{Y}}
\newcommand{\estimator}[2]{{\hat{#1}^{\text{#2}}}}
\newcommand{\estimate}[2]{\underset{(#2)}{#1}}
\DeclareMathOperator{\plim}{plim}
\newcommand{\PLIM}[2]{#1\xrightarrow{p} #2}\end{split}\end{aligned}\end{align} \]</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">bccr</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn&#39;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">backend</span> <span class="o">=</span> <span class="s2">&quot;plotly&quot;</span>

<span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.stattools</span> <span class="kn">import</span> <span class="n">adfuller</span><span class="p">,</span> <span class="n">kpss</span>

<span class="c1"># Funciones para ayudar a hacer varias pruebas de Dickey Fuller de una sola vez</span>

<span class="k">def</span> <span class="nf">signif_una_cola</span><span class="p">(</span><span class="n">tvalues</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Para sombrear en verde los niveles a los que un test es significativo&quot;&quot;&quot;</span>

    <span class="n">is_sig</span> <span class="o">=</span> <span class="p">(</span><span class="n">tvalues</span> <span class="o">&gt;</span> <span class="n">tvalues</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;background-color: green&#39;</span> <span class="k">if</span> <span class="n">v</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">is_sig</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">DF</span><span class="p">(</span><span class="n">datos</span><span class="p">,</span> <span class="n">spec</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Prueba de Dickey-Fuller&quot;&quot;&quot;</span>

    <span class="n">res</span> <span class="o">=</span> <span class="n">adfuller</span><span class="p">(</span><span class="n">datos</span><span class="p">,</span> <span class="n">maxlag</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">regression</span><span class="o">=</span><span class="n">spec</span><span class="p">)</span>
    <span class="n">resultado</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;z&#39;</span><span class="p">:</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="s1">&#39;1%&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="s1">&#39;1%&#39;</span><span class="p">],</span>
        <span class="s1">&#39;5%&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="s1">&#39;5%&#39;</span><span class="p">],</span>
        <span class="s1">&#39;10%&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="s1">&#39;10%&#39;</span><span class="p">]}</span>
    <span class="k">return</span> <span class="n">resultado</span>

<span class="k">def</span> <span class="nf">ADF</span><span class="p">(</span><span class="n">datos</span><span class="p">,</span> <span class="n">spec</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Prueba Aumentada de Dickey-Fuller, con selección automática de rezagos&quot;&quot;&quot;</span>

    <span class="n">res</span> <span class="o">=</span> <span class="n">adfuller</span><span class="p">(</span><span class="n">datos</span><span class="p">,</span> <span class="n">regression</span><span class="o">=</span><span class="n">spec</span><span class="p">,</span> <span class="n">autolag</span><span class="o">=</span><span class="s1">&#39;t-stat&#39;</span><span class="p">)</span>
    <span class="n">resultado</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;z&#39;</span><span class="p">:</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="s1">&#39;1%&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="s1">&#39;1%&#39;</span><span class="p">],</span>
        <span class="s1">&#39;5%&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="s1">&#39;5%&#39;</span><span class="p">],</span>
        <span class="s1">&#39;10%&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="s1">&#39;10%&#39;</span><span class="p">],</span>
        <span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">[</span><span class="mi">2</span><span class="p">]}</span>
    <span class="k">return</span> <span class="n">resultado</span>


<span class="n">all_specs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;ct&#39;</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">tabla_dickey_fuller</span><span class="p">(</span><span class="n">serie</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">diff</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">specs</span><span class="o">=</span><span class="n">all_specs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Tabla resumen de pruebas Dickey-Fuller, para las tres especificaciones&quot;&quot;&quot;</span>
    <span class="n">datos</span> <span class="o">=</span> <span class="n">serie</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">while</span> <span class="n">diff</span><span class="p">:</span>
        <span class="n">datos</span> <span class="o">=</span> <span class="n">datos</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
        <span class="n">diff</span> <span class="o">-=</span><span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">datos</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>   

    <span class="n">resultados</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">test</span><span class="p">(</span><span class="n">datos</span><span class="p">,</span> <span class="n">ss</span><span class="p">)</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">specs</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">specs</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">resultados</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
        <span class="n">index</span><span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="s1">&#39;sin constante&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;con constante&#39;</span><span class="p">,</span> <span class="n">ct</span><span class="o">=</span><span class="s1">&#39;con constante y tendencia&#39;</span><span class="p">),</span>
        <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">resultados</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">signif_una_cola</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">KPSS_una_serie</span><span class="p">(</span><span class="n">datos</span><span class="p">,</span> <span class="n">tipo</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">kpss</span><span class="p">(</span><span class="n">datos</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">regression</span><span class="o">=</span><span class="n">tipo</span><span class="p">,</span> <span class="n">nlags</span><span class="o">=</span><span class="n">k</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">)]</span>   


<span class="k">def</span> <span class="nf">tabla_KPSS</span><span class="p">(</span><span class="n">diff</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">datos</span> <span class="o">=</span> <span class="n">pib</span><span class="p">[</span><span class="s1">&#39;lPIB&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span> <span class="k">if</span> <span class="n">diff</span> <span class="k">else</span> <span class="n">pib</span><span class="p">[</span><span class="s1">&#39;lPIB&#39;</span><span class="p">]</span>
    <span class="n">resultados</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">KPSS_una_serie</span><span class="p">(</span><span class="n">datos</span><span class="p">,</span> <span class="n">ss</span><span class="p">)</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;ct&#39;</span><span class="p">]],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;ct&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="c1">#nombre = &#39;_&#39;.join([test,serie,str(diff)])</span>
    <span class="c1">#resultados.to_latex(nombre + &#39;.tex&#39;)</span>
    <span class="k">return</span> <span class="n">resultados</span><span class="o">.</span><span class="n">T</span>   
</pre></div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="detectando-raices-unitarias">
<h1><span class="section-number">4.4. </span>Detectando raíces unitarias<a class="headerlink" href="#detectando-raices-unitarias" title="Permalink to this headline">#</a></h1>
<div class="section" id="la-prueba-dickey-fuller">
<h2>La prueba Dickey-Fuller<a class="headerlink" href="#la-prueba-dickey-fuller" title="Permalink to this headline">#</a></h2>
<p><strong>Caminata aleatoria como serie AR(1)</strong></p>
<p>El modelo más sencillo de una serie con raíz unitaria, la caminata aleatoria, es un  proceso AR(1)</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
y_t = \phi y_{t-1} + \epsilon_t
\end{equation*}\]</div>
<p>en el cual se cumple que <span class="math notranslate nohighlight">\(\phi=1\)</span>.</p>
<p>Entonces resulta natural, para determinar si una serie es una caminata aleatoria, estimar esta ecuación y comprobar la hipótesis <span class="math notranslate nohighlight">\(\phi=1\)</span>.</p>
<p>Alternativamente, restando <span class="math notranslate nohighlight">\(y_{t-1}\)</span> de ambos lados podemos estimar</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
y_t - y_{t-1} &amp;= (\phi-1) y_{t-1} + \epsilon_t \\
\Delta y_t &amp;= \gamma y_{t-1} + \epsilon_t
\end{align*}\]</div>
<p>y comprobar si</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
H_0:\quad \gamma_0 &amp;= 0 \qquad \text{versus} &amp; H_1:\quad \gamma_0 &amp;&lt;0
\end{align*}\]</div>
<p>No obstante, Dickey y Fuller (1979) encontraron que si la hipótesis nula es verdadera, la regresión anterior tiene series no estacionarias en ambos lados de la ecuación, por lo que no se cumple que</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
z = \frac{\hat{\gamma}}{s.e.(\gamma)}
\end{equation*}\]</div>
<p>tenga una distribución <span class="math notranslate nohighlight">\(t\)</span>-Student.</p>
<p>Para determinar la distribución de este estadístico, de manera que pueda realizarse la prueba de hipótesis, Dickey y Fuller realizaron experimentos de Monte Carlo, en los cuales</p>
<ul class="simple">
<li><p>Se simula una caminata aleatoria con un tamaño de muestra predeterminado.</p></li>
<li><p>Se estima el modelo AR(1)</p></li>
<li><p>Se calcula el valor de <span class="math notranslate nohighlight">\(z\)</span></p></li>
</ul>
<p>Realizando muchas simulaciones como la anterior es posible aproximar la verdadera distribución del estadístico <span class="math notranslate nohighlight">\(z\)</span> <strong>bajo la hipótesis nula <span class="math notranslate nohighlight">\(\gamma=0\)</span></strong>.</p>
<p><div class="test">
<div class="test-titulo">
 Las pruebas de Dickey-Fuller </div></p>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row sd-g-1 sd-g-xs-1 sd-g-sm-1 sd-g-md-1 sd-g-lg-1 docutils">
<div class="sd-col sd-d-flex-column sd-col-4 sd-col-xs-4 sd-col-sm-4 sd-col-md-4 sd-col-lg-4 sd-border-1 docutils">
<p><span class="fas fa-question test-simbolo"></span>
¿Tiene la serie <span class="math notranslate nohighlight">\(y_t\)</span> una raíz unitaria?</p>
</div>
<div class="sd-col sd-d-flex-column sd-col-8 sd-col-xs-8 sd-col-sm-8 sd-col-md-8 sd-col-lg-8 sd-border-1 docutils">
<p><span class="fas fa-bullseye test-simbolo"></span></p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\qquad
\left.\begin{aligned}
\Delta y_t &amp;= \phantom{a_0 + b_0 t +} \alert{\gamma} y_{t-1} + \epsilon_t \\
\Delta y_t &amp;= a_0 + \phantom{b_0 t +} \alert{\gamma} y_{t-1} + \epsilon_t \\
\Delta y_t &amp;= a_0 + b_0 t + \alert{\gamma} y_{t-1} + \epsilon_t
\end{aligned}\right\} \alert{\gamma = 0}
\end{equation*}\]</div>
</div>
<div class="sd-col sd-d-flex-column sd-col-6 sd-col-xs-6 sd-col-sm-6 sd-col-md-6 sd-col-lg-6 sd-border-1 docutils">
<p><span class="fas fa-calculator test-simbolo"></span>
Estimar <span class="math notranslate nohighlight">\(z = \frac{\hat{\gamma}}{s.e.(\gamma)}\)</span> por mínimos cuadrados.</p>
</div>
<div class="sd-col sd-d-flex-column sd-col-6 sd-col-xs-6 sd-col-sm-6 sd-col-md-6 sd-col-lg-6 sd-border-1 docutils">
<p><span class="fas fa-lightbulb test-simbolo"></span>
Si <span class="math notranslate nohighlight">\(z\)</span> es menor que el valor crítico de Dickey Fuller, entonces <span class="math notranslate nohighlight">\(\gamma&lt;0\)</span>, es decir, no hay raíz unitaria.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="la-distribucion-de-dickey-fuller">
<h2>La distribución de Dickey-Fuller<a class="headerlink" href="#la-distribucion-de-dickey-fuller" title="Permalink to this headline">#</a></h2>
<div class="figure align-default">
<img alt="../../_images/Dickey-Fuller.png" src="../../_images/Dickey-Fuller.png" />
</div>
<p><div class="ejemplo">
<div class="ejemplo-titulo"><b>Ejemplo:  
 Pruebas Dickey-Fuller </b></div></p>
<div class="margin sidebar">
<p class="sidebar-title">Archivos</p>
<ul class="simple">
<li><p>bccr.SW(33783)</p></li>
<li><p>tendencias-pib.ipynb</p></li>
</ul>
</div>
<p>Al estimar por mínimos cuadrados ordinarios la regresión</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\Delta\log\text{PIB}_t = c + \phi\log\text{PIB}_{t-1} + \epsilon_{t}
\end{equation*}\]</div>
<p>encontramos</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pib</span> <span class="o">=</span> <span class="n">bccr</span><span class="o">.</span><span class="n">SW</span><span class="p">(</span><span class="n">PIB</span><span class="o">=</span><span class="mi">33783</span><span class="p">)</span>
<span class="n">pib</span><span class="p">[</span><span class="s1">&#39;lPIB&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">pib</span><span class="p">[</span><span class="s1">&#39;PIB&#39;</span><span class="p">])</span>
<span class="n">pib</span><span class="p">[</span><span class="s1">&#39;ΔlPIB&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pib</span><span class="p">[</span><span class="s1">&#39;lPIB&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<span class="n">pib</span><span class="p">[</span><span class="s1">&#39;LlPIB&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pib</span><span class="p">[</span><span class="s1">&#39;lPIB&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">()</span>

<span class="n">res</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;ΔlPIB ~ LlPIB&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">pib</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">res</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Los resultados de la tabla indican que <span class="math notranslate nohighlight">\(\phi\)</span> es significativamente distinto de cero al 5% de significancia, <strong>pero este resultado es incorrecto</strong> porque en esta regresión el estadístico <span class="math notranslate nohighlight">\(t\)</span> no tiene la distribución <span class="math notranslate nohighlight">\(t\)</span>-Student.</p>
<p>Además, la prueba reportada es de dos colas, mientras que la apropiada es de una cola.</p>
<p>Por ello, recurrimos a los valores críticos de Dickey-Fuller</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tabla_dickey_fuller</span><span class="p">(</span><span class="n">pib</span><span class="p">[</span><span class="s1">&#39;lPIB&#39;</span><span class="p">],</span> <span class="n">DF</span><span class="p">,</span> <span class="n">diff</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">specs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title">REVISAR</p>
<p>Como en todos los casos el valor <span class="math notranslate nohighlight">\(z\)</span> estimado es mayor que el valor crítico de Dickey-Fuller (sin importar cuál nivel de significancia utilizamos), no podemos rechazar la hipótesis de que el PIB tenga raíz unitaria.</p>
</div>
<p>Por otra parte, si realizamos las pruebas de Dickey-Fuller a la primera diferencia del (logaritmo del) PIB trimestral encontramos</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pib</span><span class="p">[</span><span class="s1">&#39;Δ2lPIB&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pib</span><span class="p">[</span><span class="s1">&#39;ΔlPIB&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<span class="n">pib</span><span class="p">[</span><span class="s1">&#39;LΔlPIB&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pib</span><span class="p">[</span><span class="s1">&#39;ΔlPIB&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">()</span>

<span class="n">res</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;Δ2lPIB ~ LΔlPIB&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">pib</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">res</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tabla_dickey_fuller</span><span class="p">(</span><span class="n">pib</span><span class="p">[</span><span class="s1">&#39;ΔlPIB&#39;</span><span class="p">],</span> <span class="n">DF</span><span class="p">,</span> <span class="n">diff</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">specs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Como en todos los casos el valor <span class="math notranslate nohighlight">\(z\)</span> estimado es menor que el valor crítico de Dickey-Fuller (sin importar cuál nivel de significancia utilizamos), concluimos que el crecimiento trimestral del PIB es estacionario (no tiene raíz unitaria).</p>
<p>Dado que no pudimos rechazar que el PIB tuviese raíz unitaria, pero sí lo hicimos para su primer diferencia, concluimos que el PIB es una serie I(1).</p>
<p>¿Qué hubiera pasado si en vez de diferenciar la serie, le extraemos una tendencia lineal?</p>
<p>Obtenemos los residuos de la regresión</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\log\text{PIB}_t = c + at + \epsilon_{t}
\end{equation*}\]</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pib</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">pib</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">res</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;lPIB ~ t&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">pib</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">res</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pib</span><span class="p">[</span><span class="s1">&#39;lPIB&#39;</span><span class="p">],</span> <span class="n">res</span><span class="o">.</span><span class="n">fittedvalues</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">resid</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;PIB&quot;</span><span class="p">,</span> <span class="s2">&quot;Ajuste&quot;</span><span class="p">,</span> <span class="s2">&quot;Residuos&quot;</span><span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_timestamp</span><span class="p">()</span> <span class="c1"># para poder graficar con plotly</span>

<span class="n">df</span><span class="p">[[</span><span class="s2">&quot;PIB&quot;</span><span class="p">,</span> <span class="s2">&quot;Ajuste&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;PIB con tendencia lineal ajustada&quot;</span><span class="p">)</span>

<span class="n">df</span><span class="p">[[</span><span class="s2">&quot;Residuos&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Residuos&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Al aplicar las pruebas de Dickey-Fuller a los residuos, vemos que</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tabla_dickey_fuller</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">DF</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Ninguna de las pruebas rechaza la presencia de una raíz unitaria.
</div></p>
</div>
<div class="section" id="la-prueba-aumentada-de-dickey-fuller">
<h2>La prueba aumentada de Dickey-Fuller<a class="headerlink" href="#la-prueba-aumentada-de-dickey-fuller" title="Permalink to this headline">#</a></h2>
<p><strong>Caminata aleatoria como serie AR(p)</strong></p>
<p>No todas las series de tiempo pueden representarse apropiadamente como un proceso AR(1).</p>
<p>La prueba de Dickey-Fuller puede aplicarse en estos casos también, aunque con modificaciones.</p>
<p>Consideremos por ejemplo un proceso AR(2):</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
y_t &amp;= \phi_1 y_{t-1} + \phi_2 y_{t-2} + \epsilon_t \\
    &amp;= \alert{(\phi_1 + \phi_2-1)}y_{t-1} - \alert{\phi_2y_{t-1} + y_{t-1}} +\phi_2 y_{t-2} + \epsilon_t \\
y_t - y_{t-1} &amp;= (\phi_1 + \phi_2-1)y_{t-1} - \phi_2\left(y_{t-1} - y_{t-2}\right) + \epsilon_t \\
\Delta y_t &amp;= (\phi_1 + \phi_2-1)y_{t-1} - \phi_2\Delta  y_{t-1} + \epsilon_t \\
\Delta y_t &amp;= \gamma y_{t-1} + a_1\Delta  y_{t-1} + \epsilon_t
\end{align*}\]</div>
<p>Esta serie tiene raíz unitaria si <span class="math notranslate nohighlight">\(\gamma=0\)</span>.</p>
<p>Para permitir la posibilidad que la serie original sea AR(p+1), la <strong>prueba aumentada de Dickey-Fuller</strong> introduce <span class="math notranslate nohighlight">\(p\)</span> rezagos de la variable dependiente en la regresión original:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\Delta y_t &amp;= \phantom{a_0 + b_0 t +}\alert{\gamma} y_{t-1} + a_1\Delta y_{t-1} +\dots + a_p\Delta y_{t-p} + \epsilon_t \\
\Delta y_t &amp;= a_0 \phantom{ + b_0 t } + \alert{\gamma} y_{t-1} + a_1\Delta y_{t-1} +\dots + a_p\Delta y_{t-p} + \epsilon_t \\
\Delta y_t &amp;= a_0 + b_0 t + \alert{\gamma} y_{t-1} + a_1\Delta y_{t-1} +\dots + a_p\Delta y_{t-p} + \epsilon_t
\end{align*}\]</div>
<p>En cualquiera de las formulaciones, la hipótesis nula es <span class="math notranslate nohighlight">\(\gamma=0\)</span>.</p>
<p>Se utilizan los mismos valores críticos de la prueba de Dickey-Fuller.</p>
<p><div class="ejemplo">
<div class="ejemplo-titulo"><b>Ejemplo:  
 Pruebas aumentada de Dickey-Fuller </b></div></p>
<div class="margin sidebar">
<p class="sidebar-title">Archivos</p>
<ul class="simple">
<li><p>bccr.SW</p></li>
<li><p>tendencias-pib.ipynb</p></li>
</ul>
</div>
<p>Al realizar las pruebas aumentadas de Dickey-Fuller del (logaritmo del) PIB trimestral de Costa Rica encontramos</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tabla_dickey_fuller</span><span class="p">(</span><span class="n">pib</span><span class="p">[</span><span class="s1">&#39;lPIB&#39;</span><span class="p">],</span> <span class="n">ADF</span><span class="p">,</span> <span class="n">diff</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Esto confirma lo que ya habíamos encontrado: no podemos rechazar la hipótesis de que el PIB tenga raíz unitaria.
En todos los casos, el número de rezagos corresponde al máximo rezago significativo.</p>
<p>Por otra parte, si realizamos las pruebas de Dickey-Fuller a la primera diferencia del (logaritmo del) PIB trimestral encontramos</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tabla_dickey_fuller</span><span class="p">(</span><span class="n">pib</span><span class="p">[</span><span class="s1">&#39;lPIB&#39;</span><span class="p">],</span> <span class="n">ADF</span><span class="p">,</span> <span class="n">diff</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>De nuevo concluimos que el crecimiento trimestral del PIB es estacionario (no tiene raíz unitaria).
</div></p>
</div>
<div class="section" id="interpretando-una-prueba-de-dickey-fuller">
<h2>Interpretando una prueba de Dickey Fuller<a class="headerlink" href="#interpretando-una-prueba-de-dickey-fuller" title="Permalink to this headline">#</a></h2>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>En la prueba DF, no rechazar la hipótesis de que una serie tenga raíz unitaria…</p>
<ul class="simple">
<li><p><strong>no implica</strong> que la serie sí tenga tal raíz unitaria.</p></li>
<li><p>solamente decimos que <strong>no hay evidencia</strong> suficiente para descartarla con un nivel “razonable” de significancia.</p></li>
</ul>
</div>
<p>Esto es así porque bien podría ser el caso de que el verdadero valor de <span class="math notranslate nohighlight">\(\phi\)</span> sea ligeramente menor a uno (en cuyo caso el proceso AR(1) es estacionario), pero la prueba Dickey-Fuller no puede distinguirlo efectivamente de 1.</p>
</div>
<div class="section" id="potencia-de-la-distribucion-de-dickey-fuller">
<h2>Potencia de la distribución de Dickey-Fuller<a class="headerlink" href="#potencia-de-la-distribucion-de-dickey-fuller" title="Permalink to this headline">#</a></h2>
<div class="figure align-default">
<img alt="../../_images/Dickey-Fuller-power.png" src="../../_images/Dickey-Fuller-power.png" />
</div>
</div>
<div class="section" id="limitaciones-de-las-pruebas-de-raiz-unitaria">
<h2>Limitaciones de las pruebas de raíz unitaria<a class="headerlink" href="#limitaciones-de-las-pruebas-de-raiz-unitaria" title="Permalink to this headline">#</a></h2>
<p>Hemos visto que la prueba de Dickey-Fuller tienen muy poca potencia para casos en que el proceso es persistente pero no integrado. Esto es una limitación también de otras pruebas de raíz unitaria, como la de Phillips-Perron.</p>
<p>Por ello, cuando se estudian series macroeconómicas con estos tests, usualmente se encuentra que tienen raíces unitarias.</p>
<p>Esto se debe a que la hipótesis nula es que sí hay raíz unitaria, y esta hipótesis solamente se rechaza cuando existe <strong>fuerte evidencia</strong> en su contra.</p>
</div>
<div class="section" id="la-prueba-kpss">
<h2>La prueba KPSS<a class="headerlink" href="#la-prueba-kpss" title="Permalink to this headline">#</a></h2>
<p>Kwiatkowski, Phillips, Schmidt y Shin (1992) proponen una <em>prueba de estacionariedad</em>: la hipótesis nula es que la serie es estacionaria.</p>
<p>Para ello, asumen que una serie puede ser expresada como la suma de una tendencia determinística, una caminata aleatoria, y un error estacionario (no necesariamente ruido blanco):</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
y_t = \notation{\xi t}{tendencia} + \notation{r_t}{caminata} + \notation{\omega_t}{estacionario}
\end{equation*}\]</div>
<p>donde <span class="math notranslate nohighlight">\(r_t\)</span> es una caminata aleatoria</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
r_t = r_{t-1} + u_t, \qquad u_t\sim N(0, \sigma^2_u)
\end{equation*}\]</div>
<p>La hipótesis de estacionariedad es simplemente <span class="math notranslate nohighlight">\(\sigma^2_u = 0\)</span>.</p>
<p>Bajo la hipótesis nula, <span class="math notranslate nohighlight">\(r_t = r_{t-1} = \dots = r_0\)</span> una constante, por lo que la serie sería estacionaria alrededor de una tendencia:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
y_t = r_0 + \xi t + \omega_t
\end{equation*}\]</div>
<p>KPSS también consideran el caso particular en el que <span class="math notranslate nohighlight">\(\xi=0\)</span>, es decir, la serie es simplemente estacionaria.</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
y_t = r_0 +  \omega_t
\end{equation*}\]</div>
<p>En cualquiera de estos dos casos, si <span class="math notranslate nohighlight">\(e_1, e_2,\dots,e_T\)</span> son los residuos de la regresión, se define</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
S_t &amp;= \sum_{i=1}^t e_i,\quad t=1,2,\dots,T  \tag{suma parcial de residuos}\\
\hat{\sigma}^2_e &amp;= \frac{1}{T}\sum_{t=1}^Te_t^2 \tag{varianza estimada del error}
\end{align*}\]</div>
<p><span class="math notranslate nohighlight">\(\hat{\sigma}^2_e\)</span> es un estimador consistente de la varianza de la parte estacionaria <span class="math notranslate nohighlight">\(\omega_t\)</span> solo si es ruido blanco.</p>
<p>Pero en la práctica, las series económicas rara vez cumplen esa restricción, por lo que KPSS proponen esta corrección para tomar en cuenta la posible correlación de <span class="math notranslate nohighlight">\(\omega_t\)</span>:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
s^2(l) = \frac{1}{T}\sum_{t=1}^Te_t^2 +\frac{2}{T}\sum_{s=1}^{l}\left[ \left(1-\tfrac{s}{1+l}\right)\sum_{t=s+1}^{T}e_{t}e_{t-s} \right]
\end{equation*}\]</div>
<p>Así, para hacer una prueba KPSS hay que decidir:</p>
<ul class="simple">
<li><p>si incluir o no la tendencia determinística</p></li>
<li><p>cuántos rezagos <span class="math notranslate nohighlight">\(l\)</span> incluir en la estimación de la varianza <span class="math notranslate nohighlight">\(s^2(l)\)</span></p></li>
</ul>
<p><div class="test">
<div class="test-titulo">
 La prueba KPSS </div></p>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row sd-g-1 sd-g-xs-1 sd-g-sm-1 sd-g-md-1 sd-g-lg-1 docutils">
<div class="sd-col sd-d-flex-column sd-col-4 sd-col-xs-4 sd-col-sm-4 sd-col-md-4 sd-col-lg-4 sd-border-1 docutils">
<p><span class="fas fa-question test-simbolo"></span>
¿Es la serie <span class="math notranslate nohighlight">\(y_t\)</span></p>
</div>
<div class="sd-col sd-d-flex-column sd-col-8 sd-col-xs-8 sd-col-sm-8 sd-col-md-8 sd-col-lg-8 sd-border-1 docutils">
<p><span class="fas fa-bullseye test-simbolo"></span></p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
y_t &amp;= \xi t + r_t +  \omega_t \\
r_t &amp;= r_{t-1} + u_t, \qquad u_t\sim N(0, \sigma^2_u) \\
\alert{\sigma^2_u} &amp;\alert{=0}
\end{align*}\]</div>
</div>
<div class="sd-col sd-d-flex-column sd-col-6 sd-col-xs-6 sd-col-sm-6 sd-col-md-6 sd-col-lg-6 sd-border-1 docutils">
<p><span class="fas fa-calculator test-simbolo"></span></p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
LM = \sum_{t=1}^{T}\frac{S^2_t}{s^2(l)}
\end{equation*}\]</div>
</div>
<div class="sd-col sd-d-flex-column sd-col-6 sd-col-xs-6 sd-col-sm-6 sd-col-md-6 sd-col-lg-6 sd-border-1 docutils">
<p><span class="fas fa-lightbulb test-simbolo"></span>
Si <span class="math notranslate nohighlight">\(LM\)</span> es mayor que el valor crítico, rechazar la hipótesis nula y concluir que la serie tiene raíz unitaria.</p>
<p>KPSS proporcionan los siguientes valores críticos asintóticos, los cuales obtuvieron por simulación 50~000 iteraciones con muestras de 2000 datos.</p>
<p>Las pruebas son de una cola: se rechaza la hipótesis nula (de que la serie es estacionaria) cuando el estadístico LM es mayor al valor crítico seleccionado.</p>
</div>
</div>
</div>
</div>
<p><div class="ejemplo">
<div class="ejemplo-titulo"><b>Ejemplo:  
 Pruebas KPSS </b></div>
Al realizar las pruebas KPSS del (logaritmo del) PIB trimestral de Costa Rica encontramos</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">tabla_KPSS</span><span class="p">(</span><span class="n">diff</span><span class="o">=</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)],</span>
    <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;nivel&#39;</span><span class="p">,</span><span class="s1">&#39;diferencia&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">result</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Valores críticos</strong></p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">critical</span>
</pre></div>
</div>
</div>
</div>
<p>En todas las especificaciones, podemos rechazar al 1% que el PIB sea estacionario.</p>
<p>Al 5%, en ningún caso podemos rechazar que el crecimiento del PIB (diferencia del logaritomo) sea estacionaria.</p>
<p>Juntos, estos resultados señalan que el PIB es un proceso I(1).
</div></p>
<p>Ahora un ejemplo con datos de Estados Unidos.</p>
<p><div class="ejemplo">
<div class="ejemplo-titulo"><b>Ejemplo:  
 Raíces unitarias en series macroeconómicas de Estados Unidos </b></div></p>
<div class="margin sidebar">
<p class="sidebar-title">Basado en Leventis pp.160</p>
<ul class="simple">
<li><p>NelsonPlosser.ipynb</p></li>
</ul>
</div>
<p>En uno de los artículos más citados en macroeconomía, Nelson y Plosser (1982) examinaron varias series macro de uso común, averiguando si tenían raíces unitarias.</p>
<p>Aplicando la prueba aumentada de Dickey-Fuller, concluyeron que todas menos una de las series analizadas tenían raíz unitaria.</p>
<div class="figure align-default">
<img alt="../../_images/NelsonPlosser-table51.png" src="../../_images/NelsonPlosser-table51.png" />
</div>
<p>En su artículo original, KPSS aplican su prueba a las mismas series que utilizaron Nelson y Plosser.</p>
<p>Encontraron que para varias de las series no era posible rechazar la hipótesis de que fueran estacionarias alrededor de una tendencia.</p>
<div class="figure align-default">
<img alt="../../_images/KPSS-table5.png" src="../../_images/KPSS-table5.png" />
</div>
<div class="figure align-default">
<img alt="../../_images/NelsonPlosser-KPSS.png" src="../../_images/NelsonPlosser-KPSS.png" />
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./teoria\04-arima"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="03-raices-unitarias.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">4.3. </span>Series con raíz unitaria y procesos ARIMA</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="05-hp.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">4.5. </span>El filtro de Hodrick y Prescott</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Randall Romero Aguilar<br/>
  
      &copy; Copyright 2021-2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>