
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>3.6. Estimación &#8212; Apuntes de Macroeconometría</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.e2363ea40746bee74734a24ffefccd78.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mi-estilo.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="canonical" href="https://randall-romero.github.io/econometria/09-var/03-estimacion.html" />
    <link rel="shortcut icon" href="../_static/r2-logo-icon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3.7. Pronósticos con VAR" href="04-pronostico.html" />
    <link rel="prev" title="3.5. Dinámica de un VAR" href="02-dinamica.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/r2-logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Apuntes de Macroeconometría</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../00-acerca.html">
   Acerca de este libro
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Acerca de este libro
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../01-interactuando.html">
   Cómo interactuar con este libro
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02-contenido.html">
   Tipo de contenido
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Modelos de series de tiempo univariadas
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../01-intro/chapter01.html">
   1. Introducción al análisis de series de tiempo
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-intro/01-historia.html">
     1.1. Una breve historia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-intro/02-graficos.html">
     1.2. Representación gráfica de series de tiempo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-intro/03-rezagos.html">
     1.3. El operador de rezagos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-intro/04-procesos-estocasticos.html">
     1.4. Procesos estocásticos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-intro/05-series-tiempo.html">
     1.5. Series de tiempo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-intro/06-pruebas.html">
     1.6. Pruebas de series de tiempo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-intro/refs.html">
     1.7. Referencias
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../02-eqdiff/chapter02.html">
   2. Ecuaciones en diferencia
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-eqdiff/01-intro.html">
     2.1. Acerca de este capítulo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-eqdiff/02-sustitucion.html">
     2.2. Solución por sustituciones recursivas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-eqdiff/03-combinacion.html">
     2.3. Solución por combinación de soluciones homogéneas y particulares
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-eqdiff/04-operador.html">
     2.4. Solución por medio del operador de rezagos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-eqdiff/refs.html">
     2.5. Referencias
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../03-arma/chapter03.html">
   3. Modelos AutoRegresivos de Media Móvil (ARMA)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-arma/01-intro.html">
     3.5. Introducción
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-arma/02-MA.html">
     3.6. Proceso de media móvil MA(q)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-arma/03-AR.html">
     3.7. Proceso autorregresivo AR(p)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-arma/04-ARMA.html">
     3.8. Proceso autorregresivo de media móvil ARMA(p,q)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-arma/05-estimacion.html">
     3.9. Estimación de modelos ARMA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-arma/06-pronosticos.html">
     3.10. Pronósticos con modelos ARMA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-arma/refs.html">
     3.11. Referencias
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../04-arima/chapter04.html">
   4. Modelos de tendencia
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../04-arima/01-modelos-tendencia.html">
     4.3. Modelos de series con tendencia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04-arima/02-removiendo.html">
     4.4. Removiendo una tendencia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04-arima/03-raices-unitarias.html">
     4.5. Series con raíz unitaria y procesos ARIMA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04-arima/04-pruebas.html">
     4.6. Detectando raíces unitarias
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04-arima/05-hp.html">
     4.7. El filtro de Hodrick y Prescott
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04-arima/refs.html">
     4.8. Referencias
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../05-cambioestructural/chapter05.html">
   5. Cambio estructural
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../05-cambioestructural/01-chow.html">
     5.1. La prueba de Chow
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05-cambioestructural/02-conocido.html">
     5.2. Cambio estructural y raíces unitarias: fecha conocida
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05-cambioestructural/03-desconocido.html">
     5.3. Cambio estructural y raíces unitarias: fecha desconocida
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05-cambioestructural/refs.html">
     5.4. Referencias
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../06-estacional/chapter06.html">
   6. Modelos de estacionalidad
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../06-estacional/01-intro.html">
     6.1. Introducción
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06-estacional/02-sarima.html">
     6.2. Modelo ARIMA estacional
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06-estacional/03-x13arima.html">
     6.3. Ajuste estacional
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06-estacional/04-raices-unitarias.html">
     6.4. Raíces unitarias estacionales
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06-estacional/refs.html">
     6.5. Referencias
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Modelos de series de tiempo multivariadas
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../07-sur/chapter07.html">
   1. Introducción a sistemas de ecuaciones
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../07-sur/01-motivacion.html">
     1.1. Motivación
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../07-sur/02-sur.html">
     1.2. El modelo SUR
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../07-sur/refs.html">
     1.3. Referencias
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../08-sem/chapter08.html">
   2. Sistemas de ecuaciones simultáneas
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../08-sem/01-representacion.html">
     2.3. Representación
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08-sem/02-identificacion.html">
     2.4. Identificación
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08-sem/03-recursivo.html">
     2.5. El modelo recursivo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08-sem/04-error.html">
     2.6. El término de error
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08-sem/05-estimacion.html">
     2.7. Estimación
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08-sem/refs.html">
     2.8. Referencias
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="chapter09.html">
   3. Vectores Auto-Regresivos (VAR)
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01-representaciones.html">
     3.4. Representaciones alternativas de un VAR
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02-dinamica.html">
     3.5. Dinámica de un VAR
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     3.6. Estimación
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04-pronostico.html">
     3.7. Pronósticos con VAR
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="refs.html">
     3.8. Referencias
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Apéndices
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../py-intro/py-chapter.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../py-intro/01--para-que-aprender-python.html">
     Introducción a Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../py-intro/02--variables-y-operaciones-basicas.html">
     Variables y operaciones básicas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../py-intro/03--colecciones.html">
     Colecciones
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../py-intro/04--control-ejecucion.html">
     Control de ejecución
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../py-intro/05--funciones.html">
     Funciones
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../py-intro/06--modulos.html">
     Módulos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../py-intro/07--clases.html">
     Clases y objetos
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../labs/labs-chapter.html">
   Laboratorios
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../labs/ADF-simulaciones.html">
     La prueba de Dickey-Fuller
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../r-code/chapter-r.html">
   Código en R
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../r-code/R-transform.html">
     Transformaciones con R
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../r-code/R-lags.html">
     Rezagos con R
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../r-code/R-correlogram.html">
     Correlogramas con R
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../matematica/matematica.html">
   Matemática
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../matematica/01-algebra-lineal.html">
     Álgebra lineal
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../matematica/02-numeros-complejos.html">
     Números complejos
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../estadistica/estadistica.html">
   Estadística y econometría
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../estadistica/01-estadistica.html">
     Resultados de teoría estadística
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../estadistica/02-econometria.html">
     Resultados de econometría
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  <a href="http://randall-romero.com">randall-romero.com</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../_sources/09-var/03-estimacion.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/09-var/03-estimacion.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/randall-romero/econometria/master?urlpath=lab/tree/./09-var/03-estimacion.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#especificacion-de-un-var">
   Especificación de un VAR
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#estimacion-de-un-var">
   Estimación de un VAR
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#estimacion-de-un-var-no-estacionario">
   Estimación de un VAR no estacionario
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#escogiendo-el-optimo-numero-de-rezagos-del-var">
   Escogiendo el óptimo número de rezagos del VAR
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#escogiendo-el-p-optimo-con-pruebas-de-significancia">
   Escogiendo el
   <span class="math notranslate nohighlight">
    \(p\)
   </span>
   óptimo con pruebas de significancia
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#escogiendo-el-p-optimo-con-criterios-de-seleccion">
   Escogiendo el
   <span class="math notranslate nohighlight">
    \(p\)
   </span>
   óptimo con criterios de selección
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#usando-un-var-para-describir-los-datos">
   Usando un VAR para describir los datos
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#causalidad-de-granger">
   Causalidad de Granger
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\require{color}
\newcommand{\alert}[1]{{\color{RedOrange} #1}}
\newcommand{\notation}[2]{\underset{\color{MidnightBlue}\text{#2}}{#1}}
\newcommand{\simbolo}[2]{\underset{\color{MidnightBlue}#2}{#1}}
\newcommand{\notationbrace}[2]{{\underbrace{#1}_{\color{MidnightBlue}\text{#2}}}}
\DeclareMathOperator{\dd}{\,d\!}
\DeclareMathOperator{\E}{\mathbb{E}{}}
\DeclareMathOperator{\Var}{Var{}}
\DeclareMathOperator{\Cov}{Cov{}}
\DeclareMathOperator{\Lag}{L{}}
\DeclareMathOperator*{\argmin}{argmin}
\DeclareMathOperator*{\argmax}{argmax}
\DeclareMathOperator{\Prob}{\mathbb{P}}
\newcommand{\marginal}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\MAT}[1]{\begin{bmatrix} #1 \end{bmatrix}}
\newcommand{\mat}[1]{\left[\begin{smallmatrix} #1 \end{smallmatrix}\right]}\\\begin{split}\DeclareMathOperator{\R}{\mathbb{R}}
\DeclareMathOperator{\X}{\mathbf{x}}
\DeclareMathOperator{\y}{\mathbf{y}}
\DeclareMathOperator{\h}{\mathbf{h}}
\newcommand{\stackEq}[1]{\MAT{#1_1 \\ #1_2 \\ \vdots \\ #1_M}}
\newcommand{\e}{\mathbf{\epsilon}}
\newcommand{\Y}{\mathbf{Y}}
\newcommand{\estimator}[2]{{\hat{#1}^{\text{#2}}}}
\newcommand{\estimate}[2]{\underset{(#2)}{#1}}
\DeclareMathOperator{\plim}{plim}
\newcommand{\PLIM}[2]{#1\xrightarrow{p} #2}\end{split}\end{aligned}\end{align} \]</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.api</span> <span class="kn">import</span> <span class="n">VAR</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1995</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="estimacion">
<h1><span class="section-number">3.6. </span>Estimación<a class="headerlink" href="#estimacion" title="Permalink to this headline">¶</a></h1>
<div class="section" id="especificacion-de-un-var">
<h2>Especificación de un VAR<a class="headerlink" href="#especificacion-de-un-var" title="Permalink to this headline">¶</a></h2>
<p>Para especificar un VAR, hay dos cosas que escoger:</p>
<ol class="simple">
<li><p>Las <span class="math notranslate nohighlight">\(n\)</span> series que conforman el VAR</p></li>
<li><p>El número <span class="math notranslate nohighlight">\(p\)</span> de rezagos a ser incluidos en el modelo</p></li>
</ol>
<p>En contraste con la metodología de Box-Jenkins, el modelo VAR no es parsimonioso <span class="math notranslate nohighlight">\(\Rightarrow\)</span> un VAR está sobreparametrizado:</p>
<ul class="simple">
<li><p>hay <span class="math notranslate nohighlight">\(n + pn^2\)</span> parámetros.</p></li>
<li><p>muchos de sus coeficientes no son significativos</p></li>
<li><p>regresores posiblemente son altamente colineales, estadísticos <span class="math notranslate nohighlight">\(t\)</span> no confiables.</p></li>
</ul>
<p>No obstante, en un VAR los coeficientes individuales no son de interés. Interesa determinar la dinámica del modelo (impulso respuesta) y la causalidad (Granger, que estudiaremos en la siguiente sección).</p>
</div>
<div class="section" id="estimacion-de-un-var">
<h2>Estimación de un VAR<a class="headerlink" href="#estimacion-de-un-var" title="Permalink to this headline">¶</a></h2>
<p>El VAR reducido es un sistema de ecuaciones SUR, donde todas las ecuaciones tienen los mismos regresores.</p>
<p>Por lo tanto, la estimación OLS ecuación por ecuación es insesgada, eficiente y consistente.</p>
<p>La matriz de covarianza de los errores se estima a partir de los residuos</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\hat{\Omega} =\frac{1}{T-np-1}\sum_{t=1}^{T}\hat{\epsilon_t}\hat{\epsilon_t}'
\end{equation*}\]</div>
</div>
<div class="section" id="estimacion-de-un-var-no-estacionario">
<h2>Estimación de un VAR no estacionario<a class="headerlink" href="#estimacion-de-un-var-no-estacionario" title="Permalink to this headline">¶</a></h2>
<p>Si las series son I(1), ¿hay que diferenciarlas para estimar el VAR? Hay un debate respecto:</p>
<div class="sphinx-bs container pb-4 docutils">
<div class="row docutils">
<div class="d-flex col-lg-6 col-md-6 col-sm-6 col-xs-12 p-2 docutils">
<div class="card w-100 shadow docutils">
<div class="card-header bg-danger text-center text-white docutils">
<p class="card-text">NO:</p>
</div>
<div class="card-body docutils">
<p class="card-text">Algunos aconsejan no diferenciar las series, porque se pierde información, alegando que la meta del VAR es determinar relaciones entre variables, no los parámetros mismos.</p>
</div>
</div>
</div>
<div class="d-flex col-lg-6 col-md-6 col-sm-6 col-xs-12 p-2 docutils">
<div class="card w-100 shadow docutils">
<div class="card-header bg-success text-center text-white docutils">
<p class="card-text">SÍ:</p>
</div>
<div class="card-body docutils">
<p class="card-text">Otros advierten que si las series son integradas, el VAR en niveles no es consistente con el proceso generador de datos. En este caso se aconseja estudiar la cointegración de las series <span class="math notranslate nohighlight">\(\Rightarrow\)</span> VECM</p>
</div>
</div>
</div>
</div>
</div>
<p><div class="ejemplo">
<div class="ejemplo-titulo"><b>Ejemplo:  
 Propiedades de la estimación OLS de un VAR estacionario </b></div></p>
<p>En este ejemplo simulamos realizaciones del VAR(1)</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
x_t &amp;= 0.8x_{t-1} + 0.7y_{t-1} + \epsilon_{x,t} \\
y_t &amp;= -0.2x_{t-1} + 0.5y_{t-1} + \epsilon_{y,t}
\end{align*}\]</div>
<p>que puede escribirse</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\notation{\begin{pmatrix}x_t \\ y_t\end{pmatrix}}{$Y_t$} &amp;=
\notation{\begin{pmatrix}0.8 &amp; 0.7 \\ -0.2 &amp; 0.5\end{pmatrix}}{$\Phi$}
\notation{\begin{pmatrix}x_{t-1} \\ y_{t-1}\end{pmatrix}}{$Y_{t-1}$} +
\notation{\begin{pmatrix}\epsilon_{x,t} \\ \epsilon_{y,t}\end{pmatrix}}{$\epsilon_t$}
\\ \\
\Omega &amp;= \begin{pmatrix}0.9 &amp; 0 \\ 0 &amp; 0.9\end{pmatrix}
\end{align*}\]</div>
<p>y las utilizamos para estimar los párametros originales por OLS. El objetivo es ilustrar que este estimador está insesgado y que es consistente.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Funciones auxiliares:</span>
<span class="c1"># Definimos las matrices de parámetros $\Phi$ y $\Omega$. Declaramos dos funciones: para simular una muestra de observaciones del VAR, y otra para estimar los coeficientes de $\Phi$ a partir de tales simulaciones.</span>


<span class="n">Φ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]])</span>
<span class="n">param_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;$Φ_</span><span class="si">{11}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$Φ_</span><span class="si">{21}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$Φ_</span><span class="si">{12}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$Φ_</span><span class="si">{22}</span><span class="s1">$&#39;</span><span class="p">]</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">0.9</span>

<span class="k">def</span> <span class="nf">var_sample</span><span class="p">(</span><span class="n">T</span> <span class="o">=</span> <span class="mi">100</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Simula el VAR(1) T períodos&#39;&#39;&#39;</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">T</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="n">Y</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">@</span> <span class="n">Φ</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># transpuesta es más rápido</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">Φ_ols</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Estima un VAR(1) a partir de datos, retorna coeficientes como vector&#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">VAR</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">coefs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><span class="sphinx-bs badge badge-primary">La estimación OLS de un VAR es insesgada</span></p>
<p>Con un experimento de Monte Carlo obtenemos 10000 muestras de <span class="math notranslate nohighlight">\(T=100\)</span> observaciones del VAR. Para cada muestra estimamos el VAR y colectamos los coeficientes estimados.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">nrepetitions</span> <span class="o">=</span> <span class="mi">10_000</span>
<span class="n">estimates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
     <span class="p">[</span><span class="n">Φ_ols</span><span class="p">(</span><span class="n">var_sample</span><span class="p">())</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrepetitions</span><span class="p">)],</span>                         <span class="n">columns</span><span class="o">=</span><span class="n">param_names</span><span class="p">)</span>

<span class="n">estimates</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 1min 55s, sys: 5.13 s, total: 2min 1s
Wall time: 30.3 s
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>$Φ_{11}$</th>
      <th>$Φ_{21}$</th>
      <th>$Φ_{12}$</th>
      <th>$Φ_{22}$</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.691685</td>
      <td>0.679327</td>
      <td>-0.276123</td>
      <td>0.428017</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.779543</td>
      <td>0.763695</td>
      <td>-0.186702</td>
      <td>0.584590</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.827301</td>
      <td>0.837952</td>
      <td>-0.278445</td>
      <td>0.444311</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.826135</td>
      <td>0.791333</td>
      <td>-0.343680</td>
      <td>0.382260</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.819778</td>
      <td>0.615994</td>
      <td>-0.153597</td>
      <td>0.315891</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Luego graficamos la distribución de cada columna (estimaciones de uno de los parámetros) con un histograma. Observe cómo la distribución estimada está centrada alrededor del verdadero parámetro en cada uno de los gráficos.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">estimates</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Φ</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">],</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/03-estimacion_7_0.png" src="../_images/03-estimacion_7_0.png" />
</div>
</div>
<p><span class="sphinx-bs badge badge-primary">La estimación OLS de un VAR es consistente</span></p>
<p>Para ilustrar que la estimación OLS de un VAR es consistente, simulamos una sola muestra de datos y vamos agregando una nueva observación. En cada paso estimamos el VAR con OLS. Observe que conforme aumenta el número de observaciones, los valores estimados convergen a los parámetros poblacionales.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">XpX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">XpY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>

<span class="n">T</span> <span class="o">=</span> <span class="mi">4000</span>
<span class="n">minT</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">Xest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">Φ</span> <span class="o">@</span> <span class="n">xlag</span> <span class="o">+</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">XpX</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">xlag</span><span class="p">,</span> <span class="n">xlag</span><span class="p">)</span>
    <span class="n">XpY</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">xlag</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="n">xlag</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">t</span><span class="o">&gt;</span><span class="n">minT</span><span class="p">:</span>
        <span class="n">Xest</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">XpX</span><span class="o">/</span><span class="n">t</span><span class="p">,</span> <span class="n">XpY</span><span class="o">/</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>


<span class="n">estimates2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">Xest</span><span class="p">[</span><span class="n">minT</span><span class="p">:],</span> <span class="n">columns</span><span class="o">=</span><span class="n">param_names</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">estimates2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">Φ</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">],</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/03-estimacion_9_0.png" src="../_images/03-estimacion_9_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="escogiendo-el-optimo-numero-de-rezagos-del-var">
<h2>Escogiendo el óptimo número de rezagos del VAR<a class="headerlink" href="#escogiendo-el-optimo-numero-de-rezagos-del-var" title="Permalink to this headline">¶</a></h2>
<p>La selección del número de rezagos <span class="math notranslate nohighlight">\(p\)</span> es crítica.</p>
<div class="sphinx-bs container pb-4 docutils">
<div class="row docutils">
<div class="d-flex col-lg-6 col-md-6 col-sm-6 col-xs-12 p-2 docutils">
<div class="card w-100 shadow docutils">
<div class="card-header bg-danger text-center text-white docutils">
<p class="card-text">Si <span class="math notranslate nohighlight">\(p\)</span> es demasiado pequeño</p>
</div>
<div class="card-body docutils">
<p class="card-text">el modelo está mal especificado</p>
</div>
</div>
</div>
<div class="d-flex col-lg-6 col-md-6 col-sm-6 col-xs-12 p-2 docutils">
<div class="card w-100 shadow docutils">
<div class="card-header bg-danger text-center text-white docutils">
<p class="card-text">Si <span class="math notranslate nohighlight">\(p\)</span> es demasiado grande</p>
</div>
<div class="card-body docutils">
<p class="card-text">se desperdician grados de libertad y se introduce colinealidad.</p>
</div>
</div>
</div>
</div>
</div>
<p>Una opción: dejar que <span class="math notranslate nohighlight">\(p\)</span> difiera para cada ecuación y variable <span class="math notranslate nohighlight">\(\Rightarrow\)</span> el VAR no podría estimarse con OLS.</p>
<p>Por tanto, se determina un sólo <span class="math notranslate nohighlight">\(p\)</span> para todas las variables y ecuaciones, usando dos enfoques distintos</p>
<ul class="simple">
<li><p>Descartando los últimos rezagos si no son significativos</p></li>
<li><p>Utilizando un criterio de selección que contraponga el ajuste a los grados de libertad.</p></li>
</ul>
</div>
<div class="section" id="escogiendo-el-p-optimo-con-pruebas-de-significancia">
<h2>Escogiendo el <span class="math notranslate nohighlight">\(p\)</span> óptimo con pruebas de significancia<a class="headerlink" href="#escogiendo-el-p-optimo-con-pruebas-de-significancia" title="Permalink to this headline">¶</a></h2>
<p>Suponga que queremos decidir entre <span class="math notranslate nohighlight">\(p\)</span> y <span class="math notranslate nohighlight">\(q\)</span> número de rezagos, con <span class="math notranslate nohighlight">\(q&lt;p\)</span>.</p>
<p>Obtenemos <span class="math notranslate nohighlight">\(\hat{\Omega}\)</span> para ambos modelos, <strong>usando la misma muestra</strong>.</p>
<p>Comprobamos la significancia conjunta de los rezagos <span class="math notranslate nohighlight">\(q+1,\dots,p\)</span> con la prueba de razón de verosimilitud</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
(T-1-pn)\left(\ln\left|\hat{\Omega}_q\right| - \ln\left|\hat{\Omega}_p\right|\right) \overset{asym}{\sim} \chi^2(n^2(p-q))
\end{equation*}\]</div>
<p>Si no se rechaza la hipótesis nula, puede escogerse <span class="math notranslate nohighlight">\(q\)</span> rezagos.</p>
<p>Limitaciones:</p>
<ul class="simple">
<li><p>Resultado asintótico, pero muestras  usualmente pequeñas</p></li>
<li><p>Resultado sensible a escogencia de <span class="math notranslate nohighlight">\(p\)</span> y <span class="math notranslate nohighlight">\(q\)</span>.</p></li>
</ul>
</div>
<div class="section" id="escogiendo-el-p-optimo-con-criterios-de-seleccion">
<h2>Escogiendo el <span class="math notranslate nohighlight">\(p\)</span> óptimo con criterios de selección<a class="headerlink" href="#escogiendo-el-p-optimo-con-criterios-de-seleccion" title="Permalink to this headline">¶</a></h2>
<p>En la práctica, el número óptimo de rezagos se escoge minimizando el valor de AIC o de SBC:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\text{AIC} &amp;= T\ln\left|\hat{\Omega}\right| + 2N \\
\text{SBC} &amp;= T\ln\left|\hat{\Omega}\right| + N\ln T \\
\end{align*}\]</div>
<p>donde <span class="math notranslate nohighlight">\(N=n^2p+n\)</span> es el número total de parámetros estimados</p>
<p>Rezagos adicionales reducen <span class="math notranslate nohighlight">\(\hat{\Omega}\)</span>, pero incrementando <span class="math notranslate nohighlight">\(N\)</span></p>
</div>
<div class="section" id="usando-un-var-para-describir-los-datos">
<h2>Usando un VAR para describir los datos<a class="headerlink" href="#usando-un-var-para-describir-los-datos" title="Permalink to this headline">¶</a></h2>
<p>La práctica usual en el análisis VAR es reportar</p>
<ul class="simple">
<li><p>pruebas de causalidad de Granger</p></li>
<li><p>funciones de impulso respuesta</p></li>
<li><p>descomposición de varianza del error de pronóstico</p></li>
</ul>
<p>Usualmente no se reportan los coeficientes estimados ni el <span class="math notranslate nohighlight">\(R^2\)</span>, porque no son tan informativos.</p>
</div>
<div class="section" id="causalidad-de-granger">
<h2>Causalidad de Granger<a class="headerlink" href="#causalidad-de-granger" title="Permalink to this headline">¶</a></h2>
<p>Las pruebas de causalidad de Granger determinan si los valores rezagados de una variable ayudan a predecir otra variable.</p>
<ul class="simple">
<li><p>Si los rezagos de <span class="math notranslate nohighlight">\(A\)</span> no ayudan a predecir <span class="math notranslate nohighlight">\(B\)</span>, entonces coeficientes de los rezagos de <span class="math notranslate nohighlight">\(A\)</span> en la ecuación de <span class="math notranslate nohighlight">\(B\)</span> son ceros.</p></li>
<li><p>Si alguna variable no es causada en el sentido de Granger por ninguna otra, <strong>no implica que la variable sea exógena</strong>. Bien podría haber causalidad contemporánea.</p></li>
</ul>
<p><div class="ejemplo">
<div class="ejemplo-titulo"><b>Ejemplo:  
 Causalidad de Granger </b></div></p>
<p>En el modelo VAR(2) con variables <span class="math notranslate nohighlight">\(y_t, m_t\)</span>:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\begin{aligned}
y_t &amp;= c^y + \alpha_{11}y_{t-1} + \alpha_{12}m_{t-1} + \beta_{11}y_{t-2} + \beta_{12}m_{t-2} + u^y_t\\
m_t &amp;= c^m + \alpha_{21}y_{t-1} + \alpha_{22}m_{t-1} + \beta_{21}y_{t-2} + \beta_{22}m_{t-2} + u^m_t
\end{aligned}
\end{equation*}\]</div>
<p>las pruebas de causalidad de Granger son:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>Hipótesis nula</p></th>
<th class="text-align:left head"><p>Restricciones</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p><span class="math notranslate nohighlight">\(m\)</span> no causa <span class="math notranslate nohighlight">\(y\)</span></p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(\alpha_{12} = \beta_{12} = 0\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><span class="math notranslate nohighlight">\(y\)</span> no causa <span class="math notranslate nohighlight">\(m\)</span></p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(\alpha_{21} = \beta_{21} = 0\)</span></p></td>
</tr>
</tbody>
</table>
<p>Si se rechaza, por ejemplo, la primera hipótesis, decimos que <strong><span class="math notranslate nohighlight">\(m\)</span> causa <span class="math notranslate nohighlight">\(y\)</span> en el sentido de Granger</strong>.
</div></p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./09-var"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="02-dinamica.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title"><span class="section-number">3.5. </span>Dinámica de un VAR</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="04-pronostico.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title"><span class="section-number">3.7. </span>Pronósticos con VAR</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Randall Romero Aguilar<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-Y3H5SWSQ3N"></script>
<script>
                    window.dataLayer = window.dataLayer || [];
                    function gtag(){ dataLayer.push(arguments); }
                    gtag('config', 'G-Y3H5SWSQ3N');
                </script>

  </body>
</html>